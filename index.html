<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Happy Birthday Lakshita ðŸ’–</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@400;500;600;700&family=Poppins:wght@300;400;500;600&family=Playfair+Display:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary-pink: #ff69b4;
            --secondary-pink: #ff1493;
            --accent-purple: #da70d6;
            --accent-blue: #87ceeb;
            --accent-gold: #ffd700;
            --dark-pink: #d63384;
            --dark-bg: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            --final-bg: linear-gradient(135deg, #8a2c6e 0%, #b03084 50%, #d63384 100%);
            --text-light: #f5f5f5;
            --transition-smooth: all 0.8s cubic-bezier(0.2, 0.8, 0.2, 1);
        }

        body {
            font-family: 'Poppins', sans-serif;
            background: var(--dark-bg);
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
            transition: var(--transition-smooth);
            opacity: 0;
            animation: fadeIn 1.5s ease forwards;
            color: var(--text-light);
        }

        @keyframes fadeIn {
            to { opacity: 1; }
        }

        /* Elegant Cursor */
        body {
            cursor: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='32' height='32' viewBox='0 0 32 32'%3E%3Cpath fill='%23ff69b4' d='M16 3C8.83 3 3 8.83 3 16s5.83 13 13 13 13-5.83 13-13S23.17 3 16 3zm0 2c6.08 0 11 4.92 11 11s-4.92 11-11 11S5 22.08 5 16 9.92 5 16 5z'/%3E%3Cpath fill='%23ff69b4' d='M16 8c-4.42 0-8 3.58-8 8s3.58 8 8 8 8-3.58 8-8-3.58-8-8-8zm0 2c3.31 0 6 2.69 6 6s-2.69 6-6 6-6-2.69-6-6 2.69-6 6-6z'/%3E%3C/svg%3E") 16 16, auto;
        }

        /* Animated Background Particles */
        .particles {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 0;
            pointer-events: none;
        }

        .particle {
            position: absolute;
            background: var(--accent-gold);
            border-radius: 50%;
            animation: float 25s infinite ease-in-out;
            opacity: 0.15;
            filter: blur(1px);
        }

        @keyframes float {
            0%, 100% { 
                transform: translateY(0) rotate(0deg) scale(1);
                opacity: 0.1;
            }
            25% { 
                transform: translateY(-80px) rotate(90deg) scale(1.1);
                opacity: 0.2;
            }
            50% { 
                transform: translateY(-160px) rotate(180deg) scale(1);
                opacity: 0.1;
            }
            75% { 
                transform: translateY(-80px) rotate(270deg) scale(0.9);
                opacity: 0.2;
            }
        }

        /* Loading Screen */
        .loading-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #8a2c6e 0%, #d63384 100%);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 10000;
            transition: all 1.2s cubic-bezier(0.2, 0.8, 0.2, 1);
        }

        .birthday-text {
            font-family: 'Dancing Script', cursive;
            font-size: 4.5rem;
            color: white;
            text-shadow: 0 5px 25px rgba(0, 0, 0, 0.3);
            margin-bottom: 40px;
            animation: heartbeat 2s infinite;
            background: linear-gradient(45deg, #ffffff, #ffd6e7);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }

        @keyframes heartbeat {
            0%, 100% { transform: scale(1); }
            25% { transform: scale(1.05); }
            50% { transform: scale(1.03); }
            75% { transform: scale(1.07); }
        }

        .loading-bar {
            width: 400px;
            height: 6px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .loading-progress {
            width: 0%;
            height: 100%;
            background: linear-gradient(90deg, #ffffff, #ffd6e7);
            border-radius: 10px;
            animation: loading 3s ease-out forwards;
            box-shadow: 0 0 20px rgba(255, 255, 255, 0.5);
        }

        @keyframes loading {
            to { width: 100%; }
        }

        /* Container */
        .container {
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            position: relative;
            z-index: 1;
        }

        /* Stage Containers */
        .stage {
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            width: 100%;
            opacity: 0;
            transform: translateY(20px);
            transition: var(--transition-smooth);
        }

        .stage.active {
            display: flex;
            opacity: 1;
            transform: translateY(0);
        }

        /* Elegant Stage Titles */
        .stage-title {
            font-family: 'Dancing Script', cursive;
            color: var(--accent-gold);
            font-size: clamp(3rem, 6vw, 4.5rem);
            margin-bottom: 50px;
            text-align: center;
            position: relative;
            padding-bottom: 25px;
            animation: titleFloat 10s ease-in-out infinite;
            text-shadow: 0 0 15px rgba(255, 215, 0, 0.4);
        }

        @keyframes titleFloat {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        .stage-title::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 150px;
            height: 3px;
            background: linear-gradient(90deg, transparent, var(--accent-gold), transparent);
            animation: lineWidth 6s ease-in-out infinite;
        }

        @keyframes lineWidth {
            0%, 100% { width: 150px; opacity: 1; }
            50% { width: 200px; opacity: 0.8; }
        }

        /* Birthday Countdown */
        .countdown-container {
            background: rgba(26, 26, 46, 0.92);
            padding: 40px 50px;
            border-radius: 30px;
            box-shadow: 0 20px 40px rgba(255, 215, 0, 0.15);
            backdrop-filter: blur(15px);
            margin: 40px 0;
            border: 2px solid rgba(255, 215, 0, 0.15);
            animation: containerFloat 8s ease-in-out infinite;
            position: relative;
            overflow: hidden;
            transition: var(--transition-smooth);
        }

        .countdown-container::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, transparent, rgba(255, 215, 0, 0.05), transparent);
            animation: shine 12s infinite linear;
        }

        @keyframes shine {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        @keyframes containerFloat {
            0%, 100% { transform: translateY(0) rotate(0deg); }
            33% { transform: translateY(-10px) rotate(0.5deg); }
            66% { transform: translateY(-5px) rotate(-0.5deg); }
        }

        .countdown-title {
            font-family: 'Dancing Script', cursive;
            color: var(--accent-gold);
            font-size: 3rem;
            text-align: center;
            margin-bottom: 30px;
            position: relative;
            z-index: 2;
        }

        .countdown-timer {
            display: flex;
            justify-content: center;
            gap: 25px;
            flex-wrap: wrap;
            position: relative;
            z-index: 2;
        }

        .countdown-unit {
            text-align: center;
            min-width: 120px;
            perspective: 1000px;
        }

        .countdown-number {
            font-size: 4rem;
            font-weight: bold;
            color: var(--accent-gold);
            background: linear-gradient(135deg, rgba(255, 215, 0, 0.1), rgba(255, 170, 0, 0.1));
            padding: 20px;
            border-radius: 20px;
            margin-bottom: 15px;
            display: inline-block;
            min-width: 110px;
            box-shadow: 
                0 10px 25px rgba(255, 215, 0, 0.15),
                inset 0 3px 10px rgba(255, 255, 255, 0.1);
            animation: pulseGlowNight 4s infinite;
            transition: var(--transition-smooth);
            transform-style: preserve-3d;
            position: relative;
            overflow: hidden;
        }

        .countdown-number::before {
            content: '';
            position: absolute;
            top: -10px;
            left: -10px;
            right: -10px;
            bottom: -10px;
            background: linear-gradient(45deg, transparent, rgba(255, 255, 255, 0.1), transparent);
            animation: numberShine 6s infinite linear;
        }

        @keyframes numberShine {
            0% { transform: translateX(-100%) rotate(45deg); }
            100% { transform: translateX(100%) rotate(45deg); }
        }

        @keyframes pulseGlowNight {
            0%, 100% { 
                transform: scale(1) rotateX(0deg);
                box-shadow: 0 10px 25px rgba(255, 215, 0, 0.15);
            }
            50% { 
                transform: scale(1.03) rotateX(3deg);
                box-shadow: 0 15px 35px rgba(255, 215, 0, 0.25), 0 0 40px rgba(255, 215, 0, 0.2);
            }
        }

        .countdown-label {
            font-size: 1.2rem;
            color: var(--text-light);
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 2px;
            margin-top: 10px;
            opacity: 0.9;
        }

        /* BEAUTIFUL HEART TREE - Enhanced */
        .tree-container {
            position: relative;
            width: 800px;
            height: 800px;
            margin: 50px 0;
        }

        .tree-structure {
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            z-index: 1;
        }

        /* Realistic Tree Trunk */
        .tree-trunk {
            width: 100px;
            height: 350px;
            background: linear-gradient(45deg, 
                #8b4513 0%, 
                #a0522d 20%, 
                #8b4513 40%, 
                #a0522d 60%, 
                #8b4513 80%, 
                #a0522d 100%);
            border-radius: 25px 25px 15px 15px;
            box-shadow: 
                0 15px 35px rgba(0, 0, 0, 0.5),
                inset 0 5px 20px rgba(255, 255, 255, 0.1),
                0 0 30px rgba(139, 69, 19, 0.3);
            position: relative;
            z-index: 2;
            overflow: hidden;
        }

        .tree-trunk::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: repeating-linear-gradient(
                90deg,
                transparent,
                transparent 10px,
                rgba(255, 255, 255, 0.05) 10px,
                rgba(255, 255, 255, 0.05) 20px
            );
            animation: barkPattern 20s infinite linear;
        }

        @keyframes barkPattern {
            0% { transform: translateX(0); }
            100% { transform: translateX(20px); }
        }

        /* Heart Leaves Container */
        .heart-leaves {
            position: absolute;
            width: 700px;
            height: 650px;
            bottom: 300px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 1;
            filter: drop-shadow(0 10px 30px rgba(0, 0, 0, 0.2));
        }

        /* Realistic Heart Leaves */
        .heart-leaf {
            position: absolute;
            width: 50px;
            height: 50px;
            background: var(--heart-color);
            clip-path: path('M 25 10 C 35 5, 45 10, 50 20 C 50 30, 40 40, 25 50 C 10 40, 0 30, 0 20 C 0 10, 15 5, 25 10');
            transform-origin: center bottom;
            animation: leafFloat 6s infinite ease-in-out;
            cursor: pointer;
            transition: var(--transition-smooth);
            filter: 
                drop-shadow(0 5px 15px rgba(0, 0, 0, 0.3))
                brightness(1.1);
            transform-style: preserve-3d;
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .heart-leaf::before {
            content: '';
            position: absolute;
            top: 5px;
            left: 5px;
            right: 5px;
            bottom: 5px;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.4), transparent);
            clip-path: path('M 25 10 C 35 5, 45 10, 50 20 C 50 30, 40 40, 25 50 C 10 40, 0 30, 0 20 C 0 10, 15 5, 25 10');
            filter: blur(1px);
        }

        .heart-leaf::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: radial-gradient(circle at 30% 30%, rgba(255, 255, 255, 0.6), transparent 70%);
            clip-path: path('M 25 10 C 35 5, 45 10, 50 20 C 50 30, 40 40, 25 50 C 10 40, 0 30, 0 20 C 0 10, 15 5, 25 10');
            opacity: 0.3;
        }

        .heart-leaf:hover {
            transform: scale(1.4) rotate(15deg) translateZ(20px);
            filter: 
                drop-shadow(0 0 30px currentColor)
                brightness(1.3);
            animation: heartPulse 1s infinite alternate;
            z-index: 10;
        }

        @keyframes leafFloat {
            0%, 100% { 
                transform: translateY(0) rotate(0deg) scale(1);
            }
            25% { 
                transform: translateY(-8px) rotate(2deg) scale(1.05);
            }
            50% { 
                transform: translateY(-5px) rotate(-1deg) scale(0.98);
            }
            75% { 
                transform: translateY(-12px) rotate(3deg) scale(1.08);
            }
        }

        @keyframes heartPulse {
            0% { transform: scale(1.3) rotate(15deg); }
            100% { transform: scale(1.5) rotate(20deg); }
        }

        /* Colorful Heart Leaf Colors */
        .heart-leaf-1 { 
            --heart-color: linear-gradient(135deg, #ff3366, #ff6699, #ff99cc); 
            animation-delay: 0s; 
        }
        .heart-leaf-2 { 
            --heart-color: linear-gradient(135deg, #ff1493, #ff69b4, #ff99cc); 
            animation-delay: 0.2s; 
        }
        .heart-leaf-3 { 
            --heart-color: linear-gradient(135deg, #da70d6, #dda0dd, #e6e6fa); 
            animation-delay: 0.4s; 
        }
        .heart-leaf-4 { 
            --heart-color: linear-gradient(135deg, #87ceeb, #b3e0ff, #e6f7ff); 
            animation-delay: 0.6s; 
        }
        .heart-leaf-5 { 
            --heart-color: linear-gradient(135deg, #ffd700, #ffed99, #fffacd); 
            animation-delay: 0.8s; 
        }
        .heart-leaf-6 { 
            --heart-color: linear-gradient(135deg, #ff9900, #ffcc66, #ffe6b3); 
            animation-delay: 1s; 
        }
        .heart-leaf-7 { 
            --heart-color: linear-gradient(135deg, #2ecc71, #85e0a3, #c8f7c5); 
            animation-delay: 1.2s; 
        }
        .heart-leaf-8 { 
            --heart-color: linear-gradient(135deg, #1abc9c, #7fd9c7, #c1f0e6); 
            animation-delay: 1.4s; 
        }
        .heart-leaf-9 { 
            --heart-color: linear-gradient(135deg, #9b59b6, #c39bd3, #e8daef); 
            animation-delay: 1.6s; 
        }
        .heart-leaf-10 { 
            --heart-color: linear-gradient(135deg, #3498db, #85c1e9, #d6eaf8); 
            animation-delay: 1.8s; 
        }

        /* Realistic Branches */
        .branch {
            position: absolute;
            background: linear-gradient(45deg, #8b4513 0%, #a0522d 30%, #8b4513 70%, #a0522d 100%);
            border-radius: 12px;
            transform-origin: bottom center;
            z-index: 2;
            box-shadow: 
                0 8px 25px rgba(0, 0, 0, 0.3),
                inset 0 2px 8px rgba(255, 255, 255, 0.2),
                0 0 20px rgba(139, 69, 19, 0.2);
        }

        .branch::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: repeating-linear-gradient(
                90deg,
                transparent,
                transparent 5px,
                rgba(255, 255, 255, 0.1) 5px,
                rgba(255, 255, 255, 0.1) 10px
            );
            border-radius: 12px;
        }

        .branch-1 { width: 350px; height: 20px; bottom: 300px; left: 140px; transform: rotate(-25deg); }
        .branch-2 { width: 320px; height: 20px; bottom: 300px; right: 140px; transform: rotate(25deg); }
        .branch-3 { width: 290px; height: 18px; bottom: 400px; left: 180px; transform: rotate(-45deg); }
        .branch-4 { width: 290px; height: 18px; bottom: 400px; right: 180px; transform: rotate(45deg); }
        .branch-5 { width: 240px; height: 15px; bottom: 500px; left: 220px; transform: rotate(-65deg); }
        .branch-6 { width: 240px; height: 15px; bottom: 500px; right: 220px; transform: rotate(65deg); }
        .branch-7 { width: 190px; height: 12px; bottom: 580px; left: 250px; transform: rotate(-85deg); }
        .branch-8 { width: 190px; height: 12px; bottom: 580px; right: 250px; transform: rotate(85deg); }

        /* Tree Title */
        .tree-title {
            position: absolute;
            top: -80px;
            left: 50%;
            transform: translateX(-50%);
            font-family: 'Dancing Script', cursive;
            color: var(--accent-gold);
            font-size: 3.2rem;
            text-align: center;
            white-space: nowrap;
            animation: titleFloat 8s infinite ease-in-out;
            text-shadow: 
                0 3px 10px rgba(0, 0, 0, 0.25),
                0 0 30px rgba(255, 215, 0, 0.4);
            padding: 20px 50px;
            background: rgba(26, 26, 46, 0.9);
            border-radius: 60px;
            backdrop-filter: blur(15px);
            border: 2px solid rgba(255, 215, 0, 0.2);
            box-shadow: 
                0 20px 40px rgba(255, 215, 0, 0.2),
                inset 0 1px 0 rgba(255, 255, 255, 0.3);
        }

        /* Tree Ground */
        .tree-ground {
            position: absolute;
            bottom: -50px;
            left: 50%;
            transform: translateX(-50%);
            width: 600px;
            height: 100px;
            background: linear-gradient(to top, #2d5016, #3a5f1d);
            border-radius: 50% 50% 0 0;
            box-shadow: 
                0 -10px 30px rgba(0, 0, 0, 0.4),
                inset 0 -10px 20px rgba(255, 255, 255, 0.1);
            z-index: 0;
        }

        .tree-ground::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 30px;
            background: linear-gradient(to top, transparent, rgba(255, 255, 255, 0.1));
            border-radius: 50% 50% 0 0;
        }

        /* BIRTHDAY CONSTELLATION STYLES */
        .constellation-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 950;
            pointer-events: none;
            opacity: 0;
            transition: opacity 3s ease;
        }
        
        .constellation-container.active {
            opacity: 1;
            pointer-events: all;
        }
        
        .constellation-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(ellipse at center, 
                rgba(26, 26, 46, 0) 0%,
                rgba(26, 26, 46, 0.4) 40%,
                rgba(26, 26, 46, 0.8) 70%,
                rgba(26, 26, 46, 0.95) 100%);
            backdrop-filter: blur(2px);
        }
        
        .constellation-star {
            position: absolute;
            width: 8px;
            height: 8px;
            background: white;
            border-radius: 50%;
            box-shadow: 
                0 0 15px rgba(255, 255, 255, 0.8),
                0 0 30px rgba(255, 215, 0, 0.6),
                0 0 45px rgba(255, 215, 0, 0.3);
            transform: scale(0);
            transition: transform 1.5s cubic-bezier(0.2, 0.8, 0.2, 1),
                      box-shadow 1.5s ease;
            cursor: pointer;
            z-index: 2;
        }
        
        .constellation-star.active {
            transform: scale(1);
            animation: starTwinkle 3s infinite alternate;
        }
        
        .constellation-star:hover {
            transform: scale(2) !important;
            box-shadow: 
                0 0 25px rgba(255, 255, 255, 1),
                0 0 50px rgba(255, 215, 0, 0.9),
                0 0 75px rgba(255, 215, 0, 0.6);
            z-index: 10;
        }
        
        .constellation-connection {
            position: absolute;
            height: 2px;
            background: linear-gradient(90deg, 
                rgba(255, 215, 0, 0) 0%, 
                rgba(255, 215, 0, 0.8) 50%, 
                rgba(255, 215, 0, 0) 100%);
            transform-origin: 0 0;
            transform: scaleX(0);
            transition: transform 2s cubic-bezier(0.2, 0.8, 0.2, 1) 0.5s;
            z-index: 1;
        }
        
        .constellation-connection.active {
            transform: scaleX(1);
        }
        
        .constellation-message {
            position: absolute;
            background: rgba(26, 26, 46, 0.95);
            border-radius: 20px;
            padding: 25px;
            max-width: 300px;
            box-shadow: 
                0 20px 50px rgba(0, 0, 0, 0.4),
                0 0 40px rgba(255, 215, 0, 0.3),
                inset 0 1px 0 rgba(255, 255, 255, 0.3);
            border: 2px solid rgba(255, 215, 0, 0.3);
            backdrop-filter: blur(15px);
            opacity: 0;
            transform: translateY(20px) scale(0.9);
            transition: all 0.8s cubic-bezier(0.2, 0.8, 0.2, 1);
            z-index: 20;
            pointer-events: none;
        }
        
        .constellation-message.active {
            opacity: 1;
            transform: translateY(0) scale(1);
            pointer-events: all;
        }
        
        .constellation-message h3 {
            font-family: 'Dancing Script', cursive;
            color: var(--accent-gold);
            font-size: 1.8rem;
            margin-bottom: 15px;
            text-align: center;
        }
        
        .constellation-message p {
            color: var(--text-light);
            font-size: 1.1rem;
            line-height: 1.6;
            text-align: center;
        }
        
        .constellation-close {
            position: absolute;
            top: 15px;
            right: 15px;
            background: transparent;
            border: none;
            color: var(--accent-gold);
            font-size: 1.2rem;
            cursor: pointer;
            transition: transform 0.3s ease;
            padding: 5px;
        }
        
        .constellation-close:hover {
            transform: scale(1.2);
        }
        
        @keyframes starTwinkle {
            0%, 100% { 
                box-shadow: 
                    0 0 15px rgba(255, 255, 255, 0.8),
                    0 0 30px rgba(255, 215, 0, 0.6),
                    0 0 45px rgba(255, 215, 0, 0.3);
            }
            50% { 
                box-shadow: 
                    0 0 20px rgba(255, 255, 255, 1),
                    0 0 40px rgba(255, 215, 0, 0.8),
                    0 0 60px rgba(255, 215, 0, 0.5);
            }
        }

        /* Fireworks Canvas - Subtle Background */
        .fireworks-canvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 900;
            opacity: 0.3;
            transition: opacity 2s ease;
        }

        .fireworks-canvas.active {
            opacity: 0.5;
        }

        /* Final Page - Movable/Scrollable */
        .final-page {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 9000;
            display: none;
            justify-content: center;
            align-items: flex-start; /* Changed from center to flex-start */
            opacity: 0;
            transition: opacity 2s ease;
            background: var(--final-bg);
            overflow-y: auto; /* Enable vertical scrolling */
            padding: 40px 20px;
        }

        .final-page.active {
            display: flex;
            opacity: 1;
        }

        .final-container {
            width: 100%;
            max-width: 900px;
            padding: 40px;
            position: relative;
            z-index: 2;
            margin-top: 40px; /* Space from top */
            margin-bottom: 100px; /* Space for scrolling */
        }

        .final-message-box {
            background: rgba(26, 26, 46, 0.95);
            padding: 80px;
            border-radius: 40px;
            box-shadow: 
                0 35px 70px rgba(0, 0, 0, 0.3),
                0 0 70px rgba(214, 51, 132, 0.2),
                inset 0 1px 0 rgba(255, 255, 255, 0.3);
            backdrop-filter: blur(25px);
            border: 3px solid rgba(255, 215, 0, 0.25);
            position: relative;
            overflow: hidden;
        }

        .final-message-box::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 8px;
            background: linear-gradient(90deg, 
                var(--dark-pink), 
                var(--accent-purple), 
                var(--accent-blue), 
                var(--accent-gold),
                var(--dark-pink));
            background-size: 300% 100%;
            animation: finalGradient 8s linear infinite;
        }

        @keyframes finalGradient {
            0% { background-position: 0% 50%; }
            100% { background-position: 300% 50%; }
        }

        /* Updated Final Page Font - Scrollable */
        .final-typing-text {
            font-family: 'Playfair Display', serif;
            font-size: 1.8rem;
            line-height: 2.2;
            color: #f8d7e8;
            white-space: pre-wrap;
            overflow-wrap: break-word;
            opacity: 0.95;
            min-height: 400px;
            padding: 20px;
            text-align: center;
            font-weight: 400;
            letter-spacing: 0.5px;
            max-height: 70vh; /* Limit height for scrolling */
            overflow-y: auto; /* Enable scrolling within text if needed */
            padding-right: 20px; /* Space for scrollbar */
        }

        /* Custom scrollbar for final page */
        .final-typing-text::-webkit-scrollbar {
            width: 8px;
        }

        .final-typing-text::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
        }

        .final-typing-text::-webkit-scrollbar-thumb {
            background: linear-gradient(180deg, var(--dark-pink), var(--accent-purple));
            border-radius: 10px;
        }

        .final-cursor {
            display: inline-block;
            width: 4px;
            height: 1.8em;
            background: linear-gradient(180deg, 
                var(--dark-pink), 
                var(--accent-purple),
                var(--accent-gold));
            margin-left: 3px;
            animation: blink 0.8s infinite;
            vertical-align: middle;
            border-radius: 3px;
        }

        @keyframes blink {
            0%, 50% { opacity: 1; transform: scaleY(1); }
            51%, 100% { opacity: 0.3; transform: scaleY(0.7); }
        }

        /* Scroll indicator for final page */
        .scroll-indicator {
            position: fixed;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            color: var(--accent-gold);
            font-size: 1.2rem;
            animation: bounce 2s infinite;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
            background: rgba(26, 26, 46, 0.8);
            padding: 10px 30px;
            border-radius: 30px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 215, 0, 0.2);
            display: none;
        }

        .scroll-indicator.active {
            display: block;
        }

        @keyframes bounce {
            0%, 100% { transform: translateX(-50%) translateY(0); }
            50% { transform: translateX(-50%) translateY(-10px); }
        }

        /* Back to Start Button */
        .back-to-start {
            position: fixed;
            bottom: 40px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 10000;
            display: none;
        }

        .back-btn {
            padding: 18px 45px;
            background: linear-gradient(135deg, 
                var(--dark-pink), 
                var(--secondary-pink),
                var(--accent-purple));
            border: none;
            border-radius: 50px;
            color: white;
            font-family: 'Poppins', sans-serif;
            font-weight: 600;
            font-size: 1.2rem;
            cursor: pointer;
            transition: var(--transition-smooth);
            display: flex;
            align-items: center;
            gap: 12px;
            box-shadow: 
                0 12px 30px rgba(214, 51, 132, 0.3),
                inset 0 1px 0 rgba(255, 255, 255, 0.5);
            position: relative;
            overflow: hidden;
            letter-spacing: 1px;
        }

        .back-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, 
                transparent, 
                rgba(255, 255, 255, 0.3), 
                transparent);
            transition: left 1s ease;
        }

        .back-btn:hover::before {
            left: 100%;
        }

        .back-btn:hover {
            transform: translateY(-4px) scale(1.03);
            box-shadow: 
                0 20px 40px rgba(214, 51, 132, 0.4),
                0 0 50px rgba(214, 51, 132, 0.2),
                inset 0 1px 0 rgba(255, 255, 255, 0.6);
        }

        /* Controls */
        .controls {
            position: fixed;
            top: 35px;
            right: 35px;
            display: flex;
            gap: 20px;
            z-index: 1000;
        }

        .control-btn {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.12);
            border: 2px solid rgba(255, 255, 255, 0.2);
            color: var(--accent-gold);
            font-size: 1.4rem;
            cursor: pointer;
            transition: var(--transition-smooth);
            display: flex;
            align-items: center;
            justify-content: center;
            backdrop-filter: blur(15px);
            box-shadow: 
                0 10px 25px rgba(0, 0, 0, 0.12),
                inset 0 1px 0 rgba(255, 255, 255, 0.4);
        }

        .control-btn:hover {
            background: rgba(255, 255, 255, 0.25);
            transform: scale(1.15);
            box-shadow: 
                0 15px 35px rgba(255, 215, 0, 0.25),
                0 0 25px rgba(255, 215, 0, 0.15),
                inset 0 1px 0 rgba(255, 255, 255, 0.6);
            color: var(--accent-gold);
        }

        .control-btn.active {
            background: rgba(255, 255, 255, 0.25);
            color: var(--accent-gold);
            transform: scale(1.1);
        }

        /* Navigation Dots */
        .nav-dots {
            position: fixed;
            bottom: 50px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 25px;
            z-index: 1000;
            background: rgba(255, 255, 255, 0.08);
            padding: 20px 45px;
            border-radius: 60px;
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.15);
            box-shadow: 
                0 12px 30px rgba(0, 0, 0, 0.12),
                inset 0 1px 0 rgba(255, 255, 255, 0.3);
        }

        .dot {
            width: 14px;
            height: 14px;
            border-radius: 50%;
            background: rgba(255, 215, 0, 0.3);
            cursor: pointer;
            transition: var(--transition-smooth);
            border: 2px solid transparent;
        }

        .dot:hover {
            transform: scale(1.6);
            background: var(--accent-gold);
        }

        .dot.active {
            background: var(--accent-gold);
            transform: scale(1.6);
            box-shadow: 
                0 0 20px var(--accent-gold),
                0 0 40px rgba(255, 215, 0, 0.4);
            border-color: white;
        }

        /* Day/Night Toggle */
        .day-night-toggle {
            position: fixed;
            top: 35px;
            left: 35px;
            z-index: 1000;
        }

        .toggle-btn {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.12);
            border: 2px solid rgba(255, 255, 255, 0.2);
            color: var(--accent-gold);
            font-size: 1.4rem;
            cursor: pointer;
            transition: var(--transition-smooth);
            display: flex;
            align-items: center;
            justify-content: center;
            backdrop-filter: blur(15px);
            box-shadow: 
                0 10px 25px rgba(0, 0, 0, 0.12),
                inset 0 1px 0 rgba(255, 255, 255, 0.4);
        }

        .toggle-btn:hover {
            background: rgba(255, 255, 255, 0.25);
            transform: scale(1.15);
            box-shadow: 
                0 15px 35px rgba(255, 215, 0, 0.25),
                0 0 25px rgba(255, 215, 0, 0.15),
                inset 0 1px 0 rgba(255, 255, 255, 0.6);
            color: var(--accent-gold);
        }

        /* Instruction Text */
        .instruction {
            color: var(--accent-gold);
            font-size: 1.2rem;
            margin-top: 35px;
            text-align: center;
            max-width: 600px;
            padding: 0 30px;
            font-weight: 500;
            opacity: 0.9;
            animation: gentlePulse 5s infinite;
            background: rgba(26, 26, 46, 0.9);
            padding: 15px 30px;
            border-radius: 25px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 215, 0, 0.15);
            box-shadow: 0 8px 25px rgba(255, 215, 0, 0.08);
        }

        @keyframes gentlePulse {
            0%, 100% { 
                opacity: 0.85;
                transform: translateY(0);
            }
            50% { 
                opacity: 1;
                transform: translateY(-3px);
            }
        }

        /* Birthday Status */
        .birthday-status {
            font-family: 'Dancing Script', cursive;
            font-size: 2.2rem;
            color: var(--accent-gold);
            text-align: center;
            margin-top: 25px;
            padding: 15px 40px;
            background: rgba(26, 26, 46, 0.9);
            border-radius: 25px;
            display: inline-block;
            transition: var(--transition-smooth);
            box-shadow: 
                0 12px 30px rgba(255, 215, 0, 0.15),
                inset 0 1px 0 rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
            border: 2px solid rgba(255, 215, 0, 0.15);
        }

        /* Final Celebration */
        .final-celebration {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at 30% 30%, rgba(214, 51, 132, 0.2), transparent),
                      radial-gradient(circle at 70% 70%, rgba(255, 20, 147, 0.15), transparent),
                      radial-gradient(circle at 50% 50%, rgba(218, 112, 214, 0.15), transparent);
            z-index: 800;
            pointer-events: none;
            opacity: 0;
            transition: opacity 3s cubic-bezier(0.2, 0.8, 0.2, 1);
        }

        .final-celebration.active {
            opacity: 1;
            animation: celebrationPulse 5s infinite alternate;
        }

        @keyframes celebrationPulse {
            0% { 
                background-size: 100% 100%, 100% 100%, 100% 100%;
                opacity: 0.7;
            }
            100% { 
                background-size: 120% 120%, 120% 120%, 120% 120%;
                opacity: 0.9;
            }
        }

        /* Heart Confetti */
        .heart-confetti {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 700;
        }

        .confetti-heart {
            position: absolute;
            font-size: 18px;
            opacity: 0;
            animation: confettiFall 10s linear forwards;
            text-shadow: 0 2px 8px currentColor;
        }

        @keyframes confettiFall {
            0% {
                transform: translateY(-100px) translateX(var(--start-x)) rotate(0deg) scale(0);
                opacity: 0;
            }
            10% {
                opacity: 0.8;
                transform: translateY(0) translateX(var(--start-x)) rotate(180deg) scale(1);
            }
            90% {
                opacity: 0.8;
                transform: translateY(calc(100vh - 50px)) translateX(var(--end-x)) rotate(720deg) scale(1);
            }
            100% {
                transform: translateY(calc(100vh + 50px)) translateX(var(--end-x)) rotate(900deg) scale(0);
                opacity: 0;
            }
        }

        /* Progress Bar for Stages */
        .stage-progress {
            position: fixed;
            top: 0;
            left: 0;
            width: 0%;
            height: 3px;
            background: linear-gradient(90deg, var(--dark-pink), var(--accent-purple), var(--accent-blue));
            z-index: 1001;
            transition: width 1s cubic-bezier(0.2, 0.8, 0.2, 1);
            box-shadow: 0 0 15px rgba(214, 51, 132, 0.4);
        }

        /* Magic Sparkles */
        .sparkle {
            position: absolute;
            width: 3px;
            height: 3px;
            background: white;
            border-radius: 50%;
            pointer-events: none;
            z-index: 999;
            animation: sparklePop 1.2s ease-out forwards;
            box-shadow: 0 0 8px white, 0 0 15px white;
        }

        @keyframes sparklePop {
            0% {
                transform: scale(0) rotate(0deg);
                opacity: 1;
            }
            50% {
                transform: scale(1) rotate(180deg);
                opacity: 1;
            }
            100% {
                transform: scale(0) rotate(360deg);
                opacity: 0;
            }
        }

        /* Custom Envelope */
        .envelope-wrapper {
            position: relative;
            width: 450px;
            height: 320px;
            cursor: pointer;
            perspective: 1800px;
            margin: 50px 0;
            filter: drop-shadow(0 20px 40px rgba(214, 51, 132, 0.3));
            transition: transform 1s ease;
        }

        .envelope-wrapper:hover {
            transform: scale(1.02) rotateY(3deg);
        }

        .envelope {
            position: absolute;
            width: 100%;
            height: 100%;
            transform-style: preserve-3d;
            transition: transform 2.5s cubic-bezier(0.2, 0.8, 0.2, 1);
        }

        .envelope-body {
            position: absolute;
            width: 100%;
            height: 100%;
            border-radius: 25px;
            overflow: hidden;
            background: linear-gradient(135deg, var(--dark-pink), var(--secondary-pink));
            box-shadow: inset 0 0 50px rgba(0, 0, 0, 0.1);
        }

        .envelope-img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            opacity: 0.95;
            transition: transform 1.5s ease;
            filter: brightness(1.1) contrast(1.1);
        }

        .envelope-flap {
            position: absolute;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, rgba(214, 51, 132, 0.95), rgba(255, 20, 147, 0.95));
            clip-path: polygon(0 0, 50% 50%, 100% 0);
            transform-origin: top;
            transition: transform 2s cubic-bezier(0.2, 0.8, 0.2, 1);
            border-radius: 25px 25px 0 0;
            box-shadow: 
                0 -10px 30px rgba(0, 0, 0, 0.2),
                inset 0 5px 15px rgba(255, 255, 255, 0.4);
            z-index: 2;
        }

        .envelope.open .envelope-flap {
            transform: rotateX(-180deg);
        }

        .envelope-seal {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 90px;
            height: 90px;
            background: linear-gradient(135deg, var(--accent-gold), #ffaa00);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 40px;
            z-index: 10;
            box-shadow: 
                0 10px 30px rgba(255, 215, 0, 0.4),
                inset 0 3px 10px rgba(255, 255, 255, 0.3);
            animation: sealGlow 3s infinite alternate;
            cursor: pointer;
            transition: var(--transition-smooth);
            overflow: hidden;
        }

        .envelope-seal::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, transparent, rgba(255, 255, 255, 0.5), transparent);
            animation: sealShine 4s infinite linear;
        }

        @keyframes sealShine {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        @keyframes sealGlow {
            from { 
                transform: translate(-50%, -50%) scale(1);
                box-shadow: 
                    0 10px 30px rgba(255, 215, 0, 0.4),
                    inset 0 3px 10px rgba(255, 255, 255, 0.3);
            }
            to { 
                transform: translate(-50%, -50%) scale(1.1);
                box-shadow: 
                    0 15px 40px rgba(255, 215, 0, 0.6),
                    0 0 60px rgba(255, 215, 0, 0.3),
                    inset 0 3px 10px rgba(255, 255, 255, 0.3);
            }
        }

        .envelope-content {
            position: absolute;
            width: 92%;
            height: 88%;
            background: rgba(26, 26, 46, 0.98);
            border-radius: 20px;
            top: 6%;
            left: 4%;
            padding: 40px;
            opacity: 0;
            transform: translateY(250px) scale(0.85);
            transition: all 1.5s cubic-bezier(0.2, 0.8, 0.2, 1) 0.6s;
            box-shadow: 
                0 20px 50px rgba(0, 0, 0, 0.2),
                inset 0 1px 0 rgba(255, 255, 255, 0.2);
            z-index: 1;
            backdrop-filter: blur(15px);
            overflow: hidden;
        }

        .envelope-content::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 6px;
            background: linear-gradient(90deg, var(--dark-pink), var(--accent-purple), var(--accent-blue));
        }

        .envelope.open .envelope-content {
            opacity: 1;
            transform: translateY(-280px) scale(1.05);
        }

        .envelope-content h2 {
            font-family: 'Dancing Script', cursive;
            color: var(--accent-gold);
            text-align: center;
            margin-bottom: 20px;
            font-size: 2.5rem;
        }

        .envelope-content p {
            text-align: center;
            color: var(--text-light);
            font-size: 1.15rem;
            line-height: 1.7;
            opacity: 0.9;
            margin-bottom: 15px;
        }

        /* Responsive Design */
        @media (max-width: 1024px) {
            .tree-container {
                width: 650px;
                height: 650px;
            }
            
            .heart-leaves {
                width: 580px;
                height: 550px;
                bottom: 250px;
            }
            
            .heart-leaf {
                width: 40px;
                height: 40px;
            }
            
            .tree-ground {
                width: 500px;
            }
        }

        @media (max-width: 768px) {
            .birthday-text {
                font-size: 3.5rem;
            }
            
            .loading-bar {
                width: 300px;
            }
            
            .envelope-wrapper {
                width: 350px;
                height: 250px;
            }
            
            .tree-container {
                width: 500px;
                height: 550px;
            }
            
            .heart-leaves {
                width: 450px;
                height: 400px;
                bottom: 220px;
            }
            
            .heart-leaf {
                width: 32px;
                height: 32px;
            }
            
            .tree-title {
                font-size: 2.2rem;
                top: -60px;
                padding: 15px 35px;
            }
            
            .tree-ground {
                width: 400px;
            }
            
            .final-container {
                padding: 20px;
            }
            
            .final-message-box {
                padding: 40px 30px;
                margin: 30px 20px;
            }
            
            .final-typing-text {
                font-size: 1.4rem;
                line-height: 1.8;
                max-height: 60vh;
            }
            
            .controls, .day-night-toggle {
                top: 25px;
                right: 25px;
            }
            
            .day-night-toggle {
                left: 25px;
            }
            
            .nav-dots {
                bottom: 30px;
                padding: 15px 30px;
                gap: 20px;
            }
            
            .control-btn, .toggle-btn {
                width: 50px;
                height: 50px;
                font-size: 1.2rem;
            }
        }

        @media (max-width: 480px) {
            .stage-title {
                font-size: 2.5rem;
                margin-bottom: 40px;
            }
            
            .birthday-text {
                font-size: 2.8rem;
            }
            
            .envelope-wrapper {
                width: 300px;
                height: 210px;
            }
            
            .tree-container {
                width: 350px;
                height: 450px;
            }
            
            .heart-leaves {
                width: 320px;
                height: 320px;
                bottom: 180px;
            }
            
            .heart-leaf {
                width: 25px;
                height: 25px;
            }
            
            .tree-title {
                font-size: 1.8rem;
                top: -50px;
                padding: 12px 25px;
            }
            
            .tree-ground {
                width: 300px;
                height: 80px;
            }
            
            .final-message-box {
                padding: 30px 20px;
            }
            
            .final-typing-text {
                font-size: 1.2rem;
                line-height: 1.6;
                max-height: 50vh;
            }
            
            .countdown-number {
                font-size: 2.5rem;
                min-width: 70px;
                padding: 12px;
            }
            
            .countdown-unit {
                min-width: 70px;
            }
            
            .birthday-status {
                font-size: 1.8rem;
                padding: 12px 25px;
            }
            
            .instruction {
                font-size: 1.1rem;
                padding: 12px 20px;
            }
        }
    </style>
</head>
<body>
    <!-- Background Music - AUTO PLAY -->
    <audio id="background-music" loop autoplay>
        <source src="song.mp3" type="audio/mpeg">
        Your browser does not support the audio element.
    </audio>

    <!-- Birthday Constellation (Hidden by default) -->
    <div id="constellation-container" class="constellation-container"></div>

    <!-- Fireworks Canvas - Subtle Background -->
    <canvas id="fireworks-canvas" class="fireworks-canvas"></canvas>

    <!-- Final Celebration Overlay -->
    <div class="final-celebration" id="final-celebration"></div>

    <!-- Heart Confetti Container -->
    <div class="heart-confetti" id="heart-confetti"></div>

    <!-- Stage Progress Bar -->
    <div class="stage-progress" id="stage-progress"></div>

    <!-- Scroll Indicator -->
    <div class="scroll-indicator" id="scroll-indicator">
        <i class="fas fa-chevron-down"></i> Scroll to read
    </div>

    <!-- Animated Background Particles -->
    <div class="particles" id="particles"></div>

    <!-- Loading Screen -->
    <div id="loading-screen" class="loading-screen">
        <div class="birthday-text">Happy Birthday Lakshita! ðŸ’–</div>
        <div class="loading-bar">
            <div class="loading-progress"></div>
        </div>
        <p style="color: white; margin-top: 30px; font-family: 'Dancing Script', cursive; font-size: 1.4rem; text-shadow: 0 2px 10px rgba(0,0,0,0.3);">
            Creating magical moments just for you...
        </p>
    </div>

    <div class="container">
        <!-- Stage 1: Birthday Countdown -->
        <div id="stage-1" class="stage active">
            <h2 class="stage-title">Birthday Countdown ðŸŽ‰</h2>
            
            <div class="countdown-container">
                <div class="countdown-title">Counting down to December 18th!</div>
                <div class="countdown-timer">
                    <div class="countdown-unit">
                        <div class="countdown-number" id="days">00</div>
                        <div class="countdown-label">Days</div>
                    </div>
                    <div class="countdown-unit">
                        <div class="countdown-number" id="hours">00</div>
                        <div class="countdown-label">Hours</div>
                    </div>
                    <div class="countdown-unit">
                        <div class="countdown-number" id="minutes">00</div>
                        <div class="countdown-label">Minutes</div>
                    </div>
                    <div class="countdown-unit">
                        <div class="countdown-number" id="seconds">00</div>
                        <div class="countdown-label">Seconds</div>
                    </div>
                </div>
                <div class="birthday-status" id="birthday-status"></div>
            </div>
            
            <p class="instruction">Get ready to celebrate Lakshita's special day! ðŸŽ‚</p>
        </div>

        <!-- Stage 2: Envelope -->
        <div id="stage-2" class="stage">
            <h2 class="stage-title">Your Birthday Invitation ðŸ’Œ</h2>
            <div class="envelope-wrapper">
                <div class="envelope">
                    <div class="envelope-body">
                        <img src="envelope.png" alt="Beautiful Birthday Envelope" class="envelope-img">
                    </div>
                    <div class="envelope-flap"></div>
                    <div class="envelope-seal">ðŸ’</div>
                    <div class="envelope-content">
                        <h2>Dearest Lakshita,</h2>
                        <p>On this beautiful day, I've prepared something very special just for you. Every moment has been crafted with love and care for the amazing person you are!</p>
                        <p style="margin-top: 15px; font-style: italic; color: var(--accent-gold);">
                            Click the golden seal to open your birthday surprise! ðŸ’–
                        </p>
                    </div>
                </div>
            </div>
            <p class="instruction">Click the golden seal to open your birthday invitation</p>
        </div>

        <!-- Stage 3: BEAUTIFUL HEART TREE -->
        <div id="stage-3" class="stage">
            <h2 class="stage-title">Your Sakura HeartTree ðŸ’–</h2>
            <div class="tree-container">
                <div class="tree-title">"Your Sakura HeartTree is blooming..."</div>
                
                <!-- Tree Ground -->
                <div class="tree-ground"></div>
                
                <!-- Branches -->
                <div class="branch branch-1"></div>
                <div class="branch branch-2"></div>
                <div class="branch branch-3"></div>
                <div class="branch branch-4"></div>
                <div class="branch branch-5"></div>
                <div class="branch branch-6"></div>
                <div class="branch branch-7"></div>
                <div class="branch branch-8"></div>
                
                <div class="tree-structure">
                    <div class="tree-trunk"></div>
                </div>
                
                <!-- Heart Leaves Container -->
                <div class="heart-leaves" id="heart-leaves"></div>
            </div>
            <p class="instruction">Click on the colorful heart leaves to discover special birthday messages! ðŸ’•</p>
        </div>

        <!-- Stage 4: Cake Celebration -->
        <div id="stage-4" class="stage">
            <h2 class="stage-title">Make a Wish! ðŸŽ‚</h2>
            <div class="cake-wrapper">
                <div class="cake-container" id="cake-container">
                    <img src="cake.jpg" alt="Beautiful Birthday Cake" class="cake-img" id="cake-img">
                    <div class="cake-overlay">
                        <div class="cake-text">Click to Cut the Cake! âœ¨</div>
                    </div>
                    <div class="candle" id="candle"></div>
                    <div class="flame" id="flame"></div>
                    <div class="cake-cut" id="cake-cut"></div>
                </div>
            </div>
            <p class="instruction">Click on the cake to cut it and celebrate with subtle fireworks! âœ¨</p>
        </div>

        <!-- Stage 5: Memory Gallery -->
        <div id="stage-5" class="stage">
            <h2 class="stage-title">Beautiful Memories ðŸ“¸</h2>
            <div class="gallery">
                <div class="gallery-item">
                    <img src="pic_one.jpg" alt="Beautiful Memory 1" class="gallery-img">
                    <div class="gallery-overlay">Lakshita's Precious Moments ðŸ’•</div>
                </div>
                <div class="gallery-item">
                    <img src="pic_two.jpg" alt="Beautiful Memory 2" class="gallery-img">
                    <div class="gallery-overlay">Special Times âœ¨</div>
                </div>
                <div class="gallery-item">
                    <img src="pic_three.png" alt="Beautiful Memory 3" class="gallery-img">
                    <div class="gallery-overlay">Cherished Memories ðŸŒ¸</div>
                </div>
            </div>
            <p class="instruction">Hover over the photos to see them come to life!</p>
        </div>
    </div>

    <!-- Final Message Page - Movable/Scrollable -->
    <div id="final-page" class="final-page">
        <div class="final-container">
            <div class="final-message-box">
                <div class="final-typing-text" id="final-typing-text"></div>
                <div class="final-cursor"></div>
            </div>
        </div>
    </div>

    <!-- Back to Start Button (Only on Final Page) -->
    <div class="back-to-start" id="back-to-start">
        <button class="back-btn" id="back-btn">
            <i class="fas fa-star"></i> Back to Start
        </button>
    </div>

    <!-- Day/Night Toggle -->
    <div class="day-night-toggle">
        <button class="toggle-btn">
            <i class="fas fa-sun"></i>
        </button>
    </div>

    <!-- Controls -->
    <div class="controls">
        <button class="control-btn active" id="music-toggle">
            <i class="fas fa-volume-up"></i>
        </button>
        <button class="control-btn" id="special-effects">
            <i class="fas fa-magic"></i>
        </button>
    </div>

    <!-- Navigation Dots -->
    <div class="nav-dots">
        <div class="dot active" data-stage="1"></div>
        <div class="dot" data-stage="2"></div>
        <div class="dot" data-stage="3"></div>
        <div class="dot" data-stage="4"></div>
        <div class="dot" data-stage="5"></div>
        <div class="dot" data-stage="final">â­</div>
    </div>

    <script>
        // Subtle Fireworks Simulator for Background
        class SubtleFireworksSimulator {
            constructor() {
                this.canvas = document.getElementById('fireworks-canvas');
                this.ctx = this.canvas.getContext('2d');
                this.particles = [];
                this.fireworks = [];
                this.hue = 120;
                this.limiterTotal = 15;
                this.limiterTick = 0;
                this.isActive = false;
                
                this.resizeCanvas();
                window.addEventListener('resize', () => this.resizeCanvas());
                
                this.animate();
            }
            
            resizeCanvas() {
                this.canvas.width = window.innerWidth;
                this.canvas.height = window.innerHeight;
            }
            
            random(min, max) {
                return Math.random() * (max - min) + min;
            }
            
            calculateDistance(p1x, p1y, p2x, p2y) {
                const xDistance = p1x - p2x;
                const yDistance = p1y - p2y;
                return Math.sqrt(Math.pow(xDistance, 2) + Math.pow(yDistance, 2));
            }
            
            createSubtleParticle(x, y, color) {
                this.particles.push({
                    x: x,
                    y: y,
                    coordinates: [],
                    coordinateCount: 8,
                    angle: this.random(0, Math.PI * 2),
                    speed: this.random(0.5, 6),
                    friction: 0.96,
                    gravity: 0.1,
                    hue: this.hue,
                    brightness: this.random(50, 70),
                    alpha: 0.7,
                    decay: this.random(0.005, 0.015),
                    color: color || `hsla(${this.hue}, 100%, 60%, 0.7)`,
                    size: this.random(1, 2.5)
                });
            }
            
            createSubtleFirework(sx, sy, tx, ty, color) {
                const firework = {
                    x: sx,
                    y: sy,
                    sx: sx,
                    sy: sy,
                    tx: tx,
                    ty: ty,
                    distanceToTarget: this.calculateDistance(sx, sy, tx, ty),
                    distanceTraveled: 0,
                    coordinates: [],
                    coordinateCount: 3,
                    angle: Math.atan2(ty - sy, tx - sx),
                    speed: 2,
                    acceleration: 1.05,
                    brightness: this.random(50, 65),
                    hue: this.hue,
                    targetRadius: 1.5,
                    color: color || `hsla(${this.hue}, 100%, 60%, 0.7)`,
                    type: 'subtle',
                    trailLength: 15
                };
                
                this.fireworks.push(firework);
                return firework;
            }
            
            launchSubtleFirework() {
                if (!this.isActive) return;
                
                const startX = this.random(100, this.canvas.width - 100);
                const startY = this.canvas.height;
                const targetX = this.random(100, this.canvas.width - 100);
                const targetY = this.random(100, this.canvas.height * 0.4);
                
                const colors = ['hsla(330, 100%, 60%, 0.7)', 'hsla(320, 100%, 60%, 0.7)', 'hsla(210, 100%, 70%, 0.7)'];
                const color = colors[Math.floor(Math.random() * colors.length)];
                
                this.createSubtleFirework(startX, startY, targetX, targetY, color);
            }
            
            explodeSubtleFirework(firework) {
                const particleCount = 40;
                
                for (let i = 0; i < particleCount; i++) {
                    const color = firework.color || `hsla(${this.hue}, 100%, 60%, 0.7)`;
                    this.createSubtleParticle(firework.x, firework.y, color);
                }
            }
            
            updateParticles() {
                for (let i = this.particles.length - 1; i >= 0; i--) {
                    const p = this.particles[i];
                    
                    p.coordinates.unshift([p.x, p.y]);
                    
                    if (p.coordinates.length > p.coordinateCount) {
                        p.coordinates.pop();
                    }
                    
                    p.speed *= p.friction;
                    p.x += Math.cos(p.angle) * p.speed;
                    p.y += Math.sin(p.angle) * p.speed + p.gravity;
                    
                    p.alpha -= p.decay;
                    
                    if (p.alpha <= p.decay || p.y > this.canvas.height) {
                        this.particles.splice(i, 1);
                    }
                }
            }
            
            updateFireworks() {
                for (let i = this.fireworks.length - 1; i >= 0; i--) {
                    const f = this.fireworks[i];
                    
                    f.coordinates.unshift([f.x, f.y]);
                    
                    if (f.coordinates.length > f.coordinateCount) {
                        f.coordinates.pop();
                    }
                    
                    if (f.targetRadius < 6) {
                        f.targetRadius += 0.3;
                    } else {
                        f.targetRadius = 1.5;
                    }
                    
                    const angle = Math.atan2(f.ty - f.sy, f.tx - f.sx);
                    const distance = this.calculateDistance(f.sx, f.sy, f.tx, f.ty);
                    f.distanceTraveled = this.calculateDistance(f.sx, f.sy, f.x, f.y);
                    
                    const currentDistance = f.distanceTraveled / distance;
                    
                    if (currentDistance >= 1) {
                        this.explodeSubtleFirework(f);
                        this.fireworks.splice(i, 1);
                    } else {
                        f.speed *= f.acceleration;
                        const velX = Math.cos(angle) * f.speed;
                        const velY = Math.sin(angle) * f.speed;
                        
                        f.x += velX;
                        f.y += velY;
                    }
                }
            }
            
            drawParticles() {
                for (let i = 0; i < this.particles.length; i++) {
                    const p = this.particles[i];
                    
                    this.ctx.beginPath();
                    this.ctx.arc(p.x, p.y, p.size, 0, Math.PI * 2);
                    this.ctx.fillStyle = p.color.replace('0.7', p.alpha.toString());
                    this.ctx.fill();
                }
            }
            
            drawFireworks() {
                for (let i = 0; i < this.fireworks.length; i++) {
                    const f = this.fireworks[i];
                    
                    this.ctx.beginPath();
                    this.ctx.arc(f.x, f.y, f.targetRadius, 0, Math.PI * 2);
                    this.ctx.fillStyle = f.color;
                    this.ctx.fill();
                }
            }
            
            animate() {
                requestAnimationFrame(() => this.animate());
                
                this.ctx.globalCompositeOperation = 'destination-out';
                this.ctx.fillStyle = 'rgba(0, 0, 0, 0.03)';
                this.ctx.fillRect(0, 0, this.canvas.width, this.canvas.height);
                this.ctx.globalCompositeOperation = 'lighter';
                
                this.hue += 0.3;
                
                if (this.isActive && this.limiterTick >= this.limiterTotal) {
                    this.launchSubtleFirework();
                    this.limiterTick = 0;
                } else {
                    this.limiterTick++;
                }
                
                this.updateFireworks();
                this.updateParticles();
                this.drawFireworks();
                this.drawParticles();
            }
            
            activate() {
                this.isActive = true;
                this.canvas.style.opacity = '0.5';
            }
            
            deactivate() {
                this.isActive = false;
                this.canvas.style.opacity = '0.3';
            }
            
            launchSubtleBurst(count = 3) {
                for (let i = 0; i < count; i++) {
                    setTimeout(() => {
                        this.launchSubtleFirework();
                    }, i * 300);
                }
            }
            
            clearAll() {
                this.particles = [];
                this.fireworks = [];
            }
        }

        document.addEventListener('DOMContentLoaded', function() {
            console.log("Page loaded successfully!");
            
            // Initialize Subtle Fireworks Simulator
            const fireworks = new SubtleFireworksSimulator();
            
            // Create animated particles
            createParticles();
            
            // Add sparkle effects on clicks
            document.addEventListener('click', createSparkles);
            
            // Background Music - AUTO PLAY
            const backgroundMusic = document.getElementById('background-music');
            let isMusicPlaying = true;
            
            // Set initial volume
            backgroundMusic.volume = 0.4;
            
            // Handle autoplay with user interaction
            let isPageLoaded = false;
            
            function startMusic() {
                if (!isPageLoaded) {
                    backgroundMusic.play().then(() => {
                        isMusicPlaying = true;
                        document.getElementById('music-toggle').innerHTML = '<i class="fas fa-volume-up"></i>';
                        document.getElementById('music-toggle').classList.add('active');
                    }).catch(e => {
                        console.log("Autoplay blocked, will play on first click");
                    });
                    isPageLoaded = true;
                }
            }
            
            // Try to start music on page load
            setTimeout(startMusic, 1000);
            
            // Also start music on first user interaction
            document.addEventListener('click', function firstClick() {
                if (!isPageLoaded) {
                    startMusic();
                }
                document.removeEventListener('click', firstClick);
            }, { once: true });
            
            // Music toggle button
            const musicBtn = document.getElementById('music-toggle');
            musicBtn.addEventListener('click', function() {
                if (isMusicPlaying) {
                    backgroundMusic.pause();
                    isMusicPlaying = false;
                    this.innerHTML = '<i class="fas fa-volume-mute"></i>';
                    this.classList.remove('active');
                    createFloatingElement('ðŸ”‡ Music Paused');
                } else {
                    backgroundMusic.play();
                    isMusicPlaying = true;
                    this.innerHTML = '<i class="fas fa-volume-up"></i>';
                    this.classList.add('active');
                    createFloatingElement('ðŸŽµ Music Playing');
                }
            });
            
            // BIRTHDAY COUNTDOWN with CONSTELLATION
            function updateCountdown() {
                const now = new Date();
                const currentYear = now.getFullYear();
                
                // Set birthday to December 18th of current year
                let birthday = new Date(currentYear, 11, 18);
                
                // If birthday has already passed this year, set to next year
                if (now > birthday) {
                    birthday = new Date(currentYear + 1, 11, 18);
                }
                
                const diff = birthday - now;
                
                const days = Math.floor(diff / (1000 * 60 * 60 * 24));
                const hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
                const seconds = Math.floor((diff % (1000 * 60)) / 1000);
                
                document.getElementById('days').textContent = days.toString().padStart(2, '0');
                document.getElementById('hours').textContent = hours.toString().padStart(2, '0');
                document.getElementById('minutes').textContent = minutes.toString().padStart(2, '0');
                document.getElementById('seconds').textContent = seconds.toString().padStart(2, '0');
                
                // Update birthday status
                const statusElement = document.getElementById('birthday-status');
                if (days === 0 && hours === 0 && minutes === 0 && seconds === 0) {
                    statusElement.textContent = "ðŸŽ‰ HAPPY BIRTHDAY LAKSHITA! ðŸŽ‰";
                    statusElement.style.animation = 'heartbeat 1.5s infinite';
                    createHeartConfetti();
                    
                    // CREATE THE BIRTHDAY CONSTELLATION!
                    setTimeout(() => {
                        createBirthdayConstellation();
                        
                        createFloatingElement('âœ¨ Click on the stars to reveal birthday wishes! âœ¨');
                        
                        // Auto-close constellation after 30 seconds
                        setTimeout(() => {
                            const constellation = document.getElementById('constellation-container');
                            if (constellation && constellation.classList.contains('active')) {
                                constellation.style.animation = 'fadeOutConstellation 3s forwards';
                                setTimeout(() => {
                                    constellation.classList.remove('active');
                                    constellation.innerHTML = '';
                                    constellation.style.animation = '';
                                    createFloatingElement('âœ¨ Birthday wishes are written in the stars forever! âœ¨');
                                }, 3000);
                            }
                        }, 30000);
                        
                    }, 1500);
                    
                } else if (days === 1) {
                    statusElement.textContent = "Birthday is tomorrow! Get ready! ðŸŽ";
                } else if (days < 7) {
                    statusElement.textContent = `Only ${days} days to go! Exciting! ðŸ¥³`;
                } else if (days < 30) {
                    statusElement.textContent = `${days} days until the big day! âœ¨`;
                } else {
                    statusElement.textContent = `Counting down to December 18th! ðŸŽ‚`;
                }
            }
            
            // Update countdown every second
            setInterval(updateCountdown, 1000);
            updateCountdown();
            
            // Hide loading screen after loading
            setTimeout(() => {
                const loadingScreen = document.getElementById('loading-screen');
                loadingScreen.style.opacity = '0';
                loadingScreen.style.transform = 'scale(1.05)';
                setTimeout(() => {
                    loadingScreen.style.display = 'none';
                    createFloatingElement('ðŸŽ‰ Welcome to Lakshita\'s Birthday! ðŸŽ‰');
                    createHeartConfetti(15);
                    
                    // Start subtle background fireworks
                    fireworks.activate();
                }, 1200);
            }, 3500);
            
            function createParticles() {
                const particlesContainer = document.getElementById('particles');
                for (let i = 0; i < 30; i++) {
                    const particle = document.createElement('div');
                    particle.className = 'particle';
                    particle.style.width = particle.style.height = (Math.random() * 20 + 10) + 'px';
                    particle.style.left = Math.random() * 100 + 'vw';
                    particle.style.top = Math.random() * 100 + 'vh';
                    particle.style.background = getRandomParticleColor();
                    particle.style.animationDelay = Math.random() * 10 + 's';
                    particle.style.animationDuration = (Math.random() * 20 + 25) + 's';
                    particlesContainer.appendChild(particle);
                }
            }
            
            function getRandomParticleColor() {
                const colors = [
                    'rgba(255, 215, 0, 0.2)',
                    'rgba(214, 51, 132, 0.2)',
                    'rgba(218, 112, 214, 0.2)',
                    'rgba(135, 206, 235, 0.2)'
                ];
                return colors[Math.floor(Math.random() * colors.length)];
            }
            
            // Create sparkle effects
            function createSparkles(e) {
                for (let i = 0; i < 5; i++) {
                    setTimeout(() => {
                        const sparkle = document.createElement('div');
                        sparkle.className = 'sparkle';
                        sparkle.style.left = (e.pageX + (Math.random() - 0.5) * 40) + 'px';
                        sparkle.style.top = (e.pageY + (Math.random() - 0.5) * 40) + 'px';
                        document.body.appendChild(sparkle);
                        
                        setTimeout(() => {
                            sparkle.remove();
                        }, 1200);
                    }, i * 60);
                }
            }
            
            // Create heart confetti
            function createHeartConfetti(count = 20) {
                const container = document.getElementById('heart-confetti');
                const hearts = ['ðŸ’–', 'ðŸ’•', 'ðŸ’—', 'ðŸ’“', 'ðŸ’ž'];
                
                for (let i = 0; i < count; i++) {
                    const heart = document.createElement('div');
                    heart.className = 'confetti-heart';
                    heart.textContent = hearts[Math.floor(Math.random() * hearts.length)];
                    
                    const startX = Math.random() * 100;
                    const endX = startX + (Math.random() - 0.5) * 30;
                    
                    heart.style.setProperty('--start-x', `${startX}vw`);
                    heart.style.setProperty('--end-x', `${endX}vw`);
                    
                    const colors = ['#ff3366', '#d63384', '#da70d6', '#87ceeb'];
                    heart.style.color = colors[Math.floor(Math.random() * colors.length)];
                    
                    heart.style.fontSize = (Math.random() * 8 + 16) + 'px';
                    heart.style.animationDelay = Math.random() * 4 + 's';
                    
                    container.appendChild(heart);
                    
                    setTimeout(() => {
                        heart.remove();
                    }, 11000);
                }
            }
            
            // Stage Navigation with smooth transitions
            const stages = document.querySelectorAll('.stage');
            const dots = document.querySelectorAll('.dot');
            let currentStage = 1;
            
            function navigateToStage(stageNumber) {
                if (stageNumber === currentStage) return;
                
                if (stageNumber === 'final') {
                    showFinalPage();
                    return;
                }
                
                // Update progress bar
                const progress = (stageNumber - 1) * 20;
                document.getElementById('stage-progress').style.width = `${progress}%`;
                
                // Smooth transition out
                stages.forEach(stage => {
                    if (stage.classList.contains('active')) {
                        stage.style.opacity = '0';
                        stage.style.transform = 'translateY(20px) scale(0.98)';
                        setTimeout(() => {
                            stage.classList.remove('active');
                        }, 600);
                    }
                });
                
                // Smooth transition in
                setTimeout(() => {
                    const targetStage = document.getElementById(`stage-${stageNumber}`);
                    if (targetStage) {
                        targetStage.classList.add('active');
                        setTimeout(() => {
                            targetStage.style.opacity = '1';
                            targetStage.style.transform = 'translateY(0) scale(1)';
                        }, 50);
                        
                        // Update navigation dots
                        dots.forEach((dot, index) => {
                            if (index === stageNumber - 1) {
                                dot.classList.add('active');
                            } else {
                                dot.classList.remove('active');
                            }
                        });
                        
                        // Special dot for final page
                        dots[5].classList.remove('active');
                        
                        currentStage = stageNumber;
                        
                        // Special initialization for each stage
                        switch(stageNumber) {
                            case 3:
                                createBeautifulHeartTree();
                                break;
                            case 4:
                                initCakeStage();
                                break;
                        }
                        
                        // Create subtle fireworks burst
                        fireworks.launchSubtleBurst(2);
                        
                        // Create floating elements
                        createFloatingElements();
                    }
                }, 650);
            }
            
            // Show final page
            function showFinalPage() {
                console.log("Showing final page");
                
                // Hide all stages
                stages.forEach(stage => {
                    stage.classList.remove('active');
                    stage.style.opacity = '0';
                });
                
                // Update dots
                dots.forEach(dot => dot.classList.remove('active'));
                dots[5].classList.add('active');
                
                // Hide back button initially
                document.getElementById('back-to-start').style.display = 'none';
                
                // Show scroll indicator
                document.getElementById('scroll-indicator').classList.add('active');
                
                // Show final page
                const finalPage = document.getElementById('final-page');
                finalPage.classList.add('active');
                setTimeout(() => {
                    finalPage.style.opacity = '1';
                }, 100);
                
                // Start typing effect
                startFinalTypingEffect();
                
                // Start celebration after typing
                setTimeout(() => {
                    createHeartConfetti(30);
                    
                    // Update birthday status
                    const statusElement = document.getElementById('birthday-status');
                    statusElement.textContent = "ðŸŽ‰ HAPPY BIRTHDAY LAKSHITA! ðŸŽ‰";
                    statusElement.style.animation = 'heartbeat 1.5s infinite';
                    
                    // Show back button
                    setTimeout(() => {
                        document.getElementById('back-to-start').style.display = 'block';
                    }, 2000);
                    
                    // Start final celebration
                    startSubtleCelebration();
                }, 7000);
                
                // Hide scroll indicator when user scrolls
                finalPage.addEventListener('scroll', () => {
                    document.getElementById('scroll-indicator').classList.remove('active');
                });
            }
            
            // Navigation dots click
            dots.forEach((dot, index) => {
                dot.addEventListener('click', (e) => {
                    createSparkles(e);
                    if (index === 5) {
                        showFinalPage();
                    } else {
                        navigateToStage(index + 1);
                    }
                });
            });
            
            // Back to start button
            document.getElementById('back-btn').addEventListener('click', function(e) {
                createSparkles(e);
                
                // Hide final page
                document.getElementById('final-page').classList.remove('active');
                document.getElementById('back-to-start').style.display = 'none';
                document.getElementById('scroll-indicator').classList.remove('active');
                
                // Navigate to stage 1
                navigateToStage(1);
            });
            
            // Stage 2: Envelope click
            const envelopeSeal = document.querySelector('.envelope-seal');
            if (envelopeSeal) {
                envelopeSeal.addEventListener('click', function(e) {
                    createSparkles(e);
                    const envelope = document.querySelector('.envelope');
                    if (!envelope.classList.contains('open')) {
                        envelope.classList.add('open');
                        createFloatingElement('âœ¨ Happy Birthday Lakshita! âœ¨');
                        createHeartConfetti(10);
                        
                        // Smooth transition to next stage
                        setTimeout(() => {
                            navigateToStage(3);
                        }, 3000);
                    }
                });
            }
            
            // Stage 4: Cake Stage with Automatic Cutting
            let cakeCut = false;
            
            function initCakeStage() {
                const cakeContainer = document.getElementById('cake-container');
                const cakeImg = document.getElementById('cake-img');
                const flame = document.getElementById('flame');
                const cakeCutElement = document.getElementById('cake-cut');
                
                // Reset cake state
                cakeCut = false;
                cakeContainer.style.transform = 'scale(1)';
                cakeImg.style.transform = 'scale(1)';
                flame.style.animation = 'flicker 0.6s infinite alternate';
                flame.style.opacity = '1';
                cakeCutElement.classList.remove('active');
                
                // Cake click event
                cakeContainer.addEventListener('click', function(e) {
                    if (!cakeCut) {
                        createSparkles(e);
                        cutCake();
                        cakeCut = true;
                    }
                });
            }
            
            function cutCake() {
                const cakeContainer = document.getElementById('cake-container');
                const cakeImg = document.getElementById('cake-img');
                const flame = document.getElementById('flame');
                const cakeCutElement = document.getElementById('cake-cut');
                
                // Blow out candle
                flame.style.animation = 'none';
                flame.style.opacity = '0';
                flame.style.transform = 'translateX(-50%) scale(0.2)';
                
                // Cake cutting animation
                cakeCutElement.classList.add('active');
                
                // Cake image animation
                cakeImg.style.transform = 'scale(1.1) rotate(5deg)';
                cakeContainer.style.transform = 'scale(1.05)';
                
                // Launch subtle fireworks burst
                setTimeout(() => {
                    createFloatingElement('âœ¨ Subtle Celebration Fireworks!');
                    createHeartConfetti(15);
                    
                    // Launch subtle fireworks
                    fireworks.launchSubtleBurst(4);
                }, 1500);
                
                // Move to next stage after delay
                setTimeout(() => {
                    navigateToStage(5);
                }, 5000);
            }
            
            // Special effects button
            document.getElementById('special-effects').addEventListener('click', function(e) {
                createSparkles(e);
                fireworks.launchSubtleBurst(3);
                createHeartConfetti(15);
                createFloatingElement('âœ¨ Subtle Magic!');
            });
            
            // Stage 3: Create Beautiful Heart Tree
            function createBeautifulHeartTree() {
                const heartLeavesContainer = document.getElementById('heart-leaves');
                if (!heartLeavesContainer) return;
                
                heartLeavesContainer.innerHTML = '';
                
                const leafClasses = [
                    'heart-leaf-1', 'heart-leaf-2', 'heart-leaf-3', 
                    'heart-leaf-4', 'heart-leaf-5', 'heart-leaf-6',
                    'heart-leaf-7', 'heart-leaf-8', 'heart-leaf-9', 'heart-leaf-10'
                ];
                
                const messages = [
                    "You're the light in my life! ðŸ’«",
                    "Stay blessed Lakshita! ðŸŒŸ",
                    "Your smile is everything! ðŸ˜Š",
                    "Wishing you endless joy! ðŸŽ‰",
                    "You're one of a kind! ðŸ’–",
                    "Stay beautiful always! ðŸŒ¸",
                    "Many happy returns! ðŸŽ‚",
                    "Enjoy your special day! ðŸ¥³",
                    "You're so special! âœ¨",
                    "Stay amazing! ðŸ’«",
                    "Sending you love! ðŸ’•",
                    "Stay happy always! ðŸ˜„",
                    "You're wonderful! ðŸŒˆ",
                    "Stay magical! ðŸ”®",
                    "You're incredible! ðŸš€",
                    "My heart beats for you! ðŸ’“",
                    "You complete me! ðŸ’ž",
                    "Forever yours! ðŸ’˜",
                    "My love for you grows! ðŸ’—",
                    "You're my everything! â¤ï¸"
                ];
                
                // Create heart leaves in a beautiful tree pattern
                const totalLeaves = 180;
                
                for (let i = 0; i < totalLeaves; i++) {
                    setTimeout(() => {
                        const leaf = document.createElement('div');
                        leaf.className = 'heart-leaf';
                        
                        // Random color class
                        const colorClass = leafClasses[Math.floor(Math.random() * leafClasses.length)];
                        leaf.classList.add(colorClass);
                        
                        // Create realistic tree shape (denser at top, sparse at bottom)
                        const layer = Math.floor(Math.random() * 5);
                        const angle = Math.random() * Math.PI * 2;
                        const baseDistance = [80, 120, 160, 200, 240];
                        const distance = baseDistance[layer] + Math.random() * 40;
                        const x = Math.cos(angle) * distance;
                        const y = Math.sin(angle) * distance * 0.7 - (layer * 60);
                        
                        leaf.style.left = `calc(50% + ${x}px)`;
                        leaf.style.top = `calc(50% + ${y}px)`;
                        
                        // Random rotation
                        const rotation = Math.random() * 360;
                        leaf.style.transform = `rotate(${rotation}deg)`;
                        
                        // Random animation delay
                        leaf.style.animationDelay = `${Math.random() * 6}s`;
                        
                        // Random size variation (smaller at top, larger at bottom)
                        const size = 0.6 + (layer * 0.1) + Math.random() * 0.3;
                        leaf.style.width = `${50 * size}px`;
                        leaf.style.height = `${50 * size}px`;
                        
                        // Add realistic leaf stem
                        const stem = document.createElement('div');
                        stem.style.position = 'absolute';
                        stem.style.width = '2px';
                        stem.style.height = '15px';
                        stem.style.background = 'linear-gradient(to bottom, #8b4513, #a0522d)';
                        stem.style.top = '100%';
                        stem.style.left = '50%';
                        stem.style.transform = 'translateX(-50%)';
                        stem.style.borderRadius = '1px';
                        leaf.appendChild(stem);
                        
                        // Click event
                        leaf.addEventListener('click', function(e) {
                            createSparkles(e);
                            const msgIndex = Math.floor(Math.random() * messages.length);
                            createFloatingElement(messages[msgIndex]);
                            
                            // Animation on click
                            this.style.transform = `scale(1.4) rotate(${rotation + 45}deg) translateZ(20px)`;
                            this.style.filter = 'drop-shadow(0 0 30px currentColor) brightness(1.3)';
                            this.style.zIndex = '100';
                            
                            // Launch a subtle firework
                            setTimeout(() => {
                                fireworks.launchSubtleFirework();
                            }, 400);
                            
                            setTimeout(() => {
                                this.style.transform = `rotate(${rotation}deg) scale(${size})`;
                                this.style.filter = 'drop-shadow(0 5px 15px rgba(0, 0, 0, 0.3)) brightness(1.1)';
                                this.style.zIndex = '1';
                            }, 1200);
                        });
                        
                        // Hover effect
                        leaf.addEventListener('mouseenter', function() {
                            this.style.transform = `rotate(${rotation + 10}deg) scale(${size * 1.2}) translateZ(10px)`;
                        });
                        
                        leaf.addEventListener('mouseleave', function() {
                            this.style.transform = `rotate(${rotation}deg) scale(${size})`;
                        });
                        
                        heartLeavesContainer.appendChild(leaf);
                    }, i * 25);
                }
                
                // Create falling leaves animation
                createFallingLeaves();
            }
            
            function createFallingLeaves() {
                const container = document.querySelector('.tree-container');
                if (!container) return;
                
                for (let i = 0; i < 15; i++) {
                    const leaf = document.createElement('div');
                    leaf.className = 'heart-leaf';
                    leaf.classList.add(`heart-leaf-${Math.floor(Math.random() * 10) + 1}`);
                    
                    leaf.style.position = 'absolute';
                    leaf.style.width = '30px';
                    leaf.style.height = '30px';
                    leaf.style.left = Math.random() * 100 + '%';
                    leaf.style.top = '-50px';
                    leaf.style.zIndex = '0';
                    leaf.style.pointerEvents = 'none';
                    leaf.style.animation = `fallingLeaf ${15 + Math.random() * 10}s linear infinite`;
                    leaf.style.animationDelay = `${Math.random() * 5}s`;
                    
                    container.appendChild(leaf);
                }
                
                // Add falling leaves animation
                const style = document.createElement('style');
                style.textContent = `
                    @keyframes fallingLeaf {
                        0% {
                            transform: translateY(0) rotate(0deg) translateX(0);
                            opacity: 0;
                        }
                        10% {
                            opacity: 1;
                        }
                        90% {
                            opacity: 1;
                        }
                        100% {
                            transform: translateY(calc(100vh + 100px)) rotate(720deg) translateX(${Math.random() * 200 - 100}px);
                            opacity: 0;
                        }
                    }
                `;
                document.head.appendChild(style);
            }
            
            // Create Birthday Constellation
            function createBirthdayConstellation() {
                console.log("Creating birthday constellation...");
                
                const container = document.getElementById('constellation-container');
                if (!container) return;
                
                container.innerHTML = '<div class="constellation-overlay"></div>';
                
                // Define star positions to spell "LAKSHITA" in elegant cursive
                const starPositions = [
                    // L
                    {x: 20, y: 30, message: "May your year be filled with laughter and joy! ðŸ˜Š"},
                    {x: 20, y: 45, message: "Wishing you endless happiness! âœ¨"},
                    {x: 25, y: 60, message: "Stay blessed always! ðŸŒŸ"},
                    
                    // A (first part)
                    {x: 35, y: 55, message: "Your smile lights up the world! ðŸ’«"},
                    {x: 40, y: 40, message: "May all your dreams come true! ðŸŒˆ"},
                    {x: 45, y: 55, message: "You deserve the very best! ðŸ’–"},
                    
                    // K
                    {x: 55, y: 30, message: "Stay as amazing as you are! ðŸŽ‰"},
                    {x: 55, y: 45, message: "Wishing you love and prosperity! ðŸ’•"},
                    {x: 60, y: 60, message: "May success follow you everywhere! ðŸš€"},
                    
                    // S
                    {x: 70, y: 35, message: "Your kindness inspires everyone! ðŸŒ¸"},
                    {x: 65, y: 50, message: "Stay healthy and strong! ðŸ’ª"},
                    {x: 75, y: 65, message: "May peace always be with you! ðŸ•Šï¸"},
                    
                    // H
                    {x: 85, y: 30, message: "Your beauty shines from within! âœ¨"},
                    {x: 85, y: 45, message: "Wishing you adventurous moments! ðŸŒ"},
                    {x: 85, y: 60, message: "Stay confident and bold! ðŸ’«"},
                    
                    // I
                    {x: 95, y: 40, message: "May creativity flow in your life! ðŸŽ¨"},
                    {x: 95, y: 50, message: "Wishing you wonderful memories! ðŸ“¸"},
                    
                    // T
                    {x: 65, y: 75, message: "Stay true to yourself always! ðŸ’Ž"},
                    {x: 70, y: 85, message: "May luck be on your side! ðŸ€"},
                    
                    // A (second part)
                    {x: 75, y: 80, message: "Your future is bright and beautiful! ðŸŒŸ"},
                    {x: 80, y: 75, message: "Stay magical every day! ðŸ”®"},
                    {x: 85, y: 80, message: "Wishing you eternal happiness! ðŸ’–"},
                    
                    // Decorative stars
                    {x: 15, y: 20, message: "You are one of a kind! ðŸ’«"},
                    {x: 30, y: 25, message: "Stay positive and optimistic! ðŸŒž"},
                    {x: 90, y: 20, message: "Your spirit is unstoppable! âš¡"},
                    {x: 80, y: 25, message: "May love surround you always! ðŸ’˜"}
                ];
                
                // Create stars
                const stars = [];
                starPositions.forEach((pos, index) => {
                    const star = document.createElement('div');
                    star.className = 'constellation-star';
                    star.dataset.index = index;
                    star.dataset.message = pos.message;
                    star.style.left = `${pos.x}%`;
                    star.style.top = `${pos.y}%`;
                    
                    const size = 6 + Math.random() * 4;
                    star.style.width = `${size}px`;
                    star.style.height = `${size}px`;
                    
                    star.style.animationDelay = `${Math.random() * 2}s`;
                    
                    star.addEventListener('click', (e) => {
                        e.stopPropagation();
                        showStarMessage(pos.x, pos.y, pos.message, star);
                    });
                    
                    container.appendChild(star);
                    stars.push(star);
                });
                
                // Define connections
                const connections = [
                    // L connections
                    {from: 0, to: 1}, {from: 1, to: 2},
                    
                    // A (first) connections
                    {from: 3, to: 4}, {from: 4, to: 5}, {from: 3, to: 5},
                    
                    // K connections
                    {from: 6, to: 7}, {from: 7, to: 8},
                    
                    // S connections
                    {from: 9, to: 10}, {from: 10, to: 11},
                    
                    // H connections
                    {from: 12, to: 13}, {from: 13, to: 14},
                    {from: 15, to: 16},
                    
                    // I connections
                    {from: 16, to: 17},
                    
                    // T connections
                    {from: 18, to: 19},
                    
                    // A (second) connections
                    {from: 20, to: 21}, {from: 21, to: 22}, {from: 20, to: 22},
                    
                    // Decorative connections
                    {from: 23, to: 0},
                    {from: 24, to: 3},
                    {from: 25, to: 22},
                    {from: 26, to: 11}
                ];
                
                // Create connections
                connections.forEach(conn => {
                    const fromStar = starPositions[conn.from];
                    const toStar = starPositions[conn.to];
                    
                    if (!fromStar || !toStar) return;
                    
                    const dx = toStar.x - fromStar.x;
                    const dy = toStar.y - fromStar.y;
                    const length = Math.sqrt(dx * dx + dy * dy);
                    const angle = Math.atan2(dy, dx) * (180 / Math.PI);
                    
                    const connection = document.createElement('div');
                    connection.className = 'constellation-connection';
                    connection.style.left = `${fromStar.x}%`;
                    connection.style.top = `${fromStar.y}%`;
                    connection.style.width = `${length}%`;
                    connection.style.transform = `rotate(${angle}deg)`;
                    
                    connection.style.boxShadow = `0 0 ${10 + Math.random() * 10}px rgba(255, 215, 0, ${0.3 + Math.random() * 0.3})`;
                    
                    container.appendChild(connection);
                });
                
                // Activate the constellation
                setTimeout(() => {
                    container.classList.add('active');
                    
                    setTimeout(() => {
                        stars.forEach((star, i) => {
                            setTimeout(() => {
                                star.classList.add('active');
                            }, i * 80);
                        });
                        
                        const connectionElements = document.querySelectorAll('.constellation-connection');
                        connectionElements.forEach((conn, i) => {
                            setTimeout(() => {
                                conn.classList.add('active');
                            }, (stars.length * 80) + (i * 60));
                        });
                        
                        setTimeout(() => {
                            container.style.animation = 'titleFloat 15s infinite ease-in-out';
                        }, 2000);
                        
                    }, 500);
                    
                }, 1000);
                
                // Click anywhere to close messages
                container.addEventListener('click', (e) => {
                    if (!e.target.classList.contains('constellation-star') && 
                        !e.target.classList.contains('constellation-message') &&
                        !e.target.classList.contains('constellation-close')) {
                        hideAllMessages();
                    }
                });
                
                return container;
            }
            
            function showStarMessage(x, y, message, starElement) {
                hideAllMessages();
                
                const messageDiv = document.createElement('div');
                messageDiv.className = 'constellation-message';
                messageDiv.innerHTML = `
                    <button class="constellation-close">&times;</button>
                    <h3>Birthday Wish âœ¨</h3>
                    <p>${message}</p>
                `;
                
                let left = x;
                let top = y + 5;
                
                if (left > 70) left -= 25;
                else left += 2;
                
                if (top > 70) top -= 20;
                
                messageDiv.style.left = `${left}%`;
                messageDiv.style.top = `${top}%`;
                
                messageDiv.querySelector('.constellation-close').addEventListener('click', (e) => {
                    e.stopPropagation();
                    messageDiv.classList.remove('active');
                    setTimeout(() => {
                        if (messageDiv.parentNode) {
                            messageDiv.parentNode.removeChild(messageDiv);
                        }
                    }, 500);
                });
                
                document.getElementById('constellation-container').appendChild(messageDiv);
                
                setTimeout(() => {
                    messageDiv.classList.add('active');
                }, 10);
                
                createSparkles({
                    pageX: starElement.getBoundingClientRect().left + starElement.offsetWidth / 2,
                    pageY: starElement.getBoundingClientRect().top + starElement.offsetHeight / 2
                });
            }
            
            function hideAllMessages() {
                document.querySelectorAll('.constellation-message').forEach(msg => {
                    msg.classList.remove('active');
                    setTimeout(() => {
                        if (msg.parentNode) {
                            msg.parentNode.removeChild(msg);
                        }
                    }, 500);
                });
            }
            
            // Typing effect for final page
            function startFinalTypingEffect() {
                const typingText = document.getElementById('final-typing-text');
                if (!typingText) return;
                
                const message = `My Dearest Lakshita,

Happy Birthday to the most wonderful person I know! ðŸŽ‰ðŸŽ‚

On this special day, I want you to know how much you mean to me. 
Your smile brightens up the darkest days, and your laughter is the most beautiful melody.

May this year bring you:
ðŸ’– Endless happiness and joy
âœ¨ Success in all your endeavors
ðŸŒ¸ Good health and prosperity
ðŸŒŸ Love that grows stronger every day
ðŸŽ‰ Adventures that create beautiful memories

You deserve all the love and happiness in the world. 
May all your dreams come true and may this birthday be as special as you are!

Wishing you the most amazing birthday ever!

With all my love and warmest wishes,
Your Secret Admirer ðŸ’

PS: Scroll down to read the complete message. Every word is written with love and care for you, my dear Lakshita. May this birthday mark the beginning of the most wonderful year of your life! ðŸ’•

Remember:
â€¢ You are stronger than you think
â€¢ More beautiful than you realize
â€¢ More loved than you can imagine
â€¢ And destined for amazing things! âœ¨

Here's to you, Lakshita - may your day be as bright and beautiful as you are! ðŸŒŸ`;

                typingText.textContent = '';
                let i = 0;
                
                function typeWriter() {
                    if (i < message.length) {
                        typingText.textContent += message.charAt(i);
                        i++;
                        setTimeout(typeWriter, 30);
                    }
                }
                
                setTimeout(typeWriter, 1000);
            }
            
            // Enhanced Floating elements
            function createFloatingElement(text) {
                const element = document.createElement('div');
                element.className = 'floating-element';
                element.textContent = text;
                element.style.position = 'fixed';
                element.style.left = Math.random() * 70 + 15 + 'vw';
                element.style.top = '100vh';
                element.style.color = getRandomColor();
                element.style.fontSize = (Math.random() * 10 + 20) + 'px';
                element.style.fontFamily = Math.random() > 0.5 ? '"Dancing Script", cursive' : '"Poppins", sans-serif';
                element.style.zIndex = Math.floor(Math.random() * 100) + 800;
                element.style.opacity = '0';
                element.style.transform = 'translateY(0) scale(0.8)';
                element.style.transition = 'all 1.5s cubic-bezier(0.2, 0.8, 0.2, 1)';
                element.style.pointerEvents = 'none';
                element.style.textShadow = '0 2px 10px rgba(0,0,0,0.3)';
                
                document.body.appendChild(element);
                
                setTimeout(() => {
                    element.style.opacity = '1';
                    element.style.transform = 'translateY(-100px) scale(1)';
                }, 10);
                
                setTimeout(() => {
                    element.style.opacity = '0';
                    element.style.transform = 'translateY(-200px) scale(0.5)';
                    setTimeout(() => {
                        element.remove();
                    }, 1500);
                }, 6000);
            }
            
            function createFloatingElements() {
                const symbols = ['ðŸ’–', 'âœ¨', 'ðŸŒŸ', 'ðŸŽ‰', 'ðŸŽ‚', 'ðŸŒ¸'];
                for (let i = 0; i < 3; i++) {
                    setTimeout(() => {
                        createFloatingElement(symbols[Math.floor(Math.random() * symbols.length)]);
                    }, i * 600);
                }
            }
            
            function getRandomColor() {
                const colors = ['#ff3366', '#d63384', '#da70d6', '#87ceeb', '#ffd700'];
                return colors[Math.floor(Math.random() * colors.length)];
            }
            
            // Subtle celebration
            function startSubtleCelebration() {
                const finalCelebration = document.getElementById('final-celebration');
                finalCelebration.classList.add('active');
                
                fireworks.canvas.style.opacity = '0.6';
                
                for (let i = 0; i < 5; i++) {
                    setTimeout(() => {
                        fireworks.launchSubtleBurst(2);
                    }, i * 800);
                }
                
                for (let i = 0; i < 15; i++) {
                    setTimeout(() => {
                        createFloatingElement('ðŸŽ‰');
                    }, i * 300);
                }
                
                createHeartConfetti(40);
            }
            
            // Day/Night mode toggle
            const toggleBtn = document.querySelector('.toggle-btn');
            if (toggleBtn) {
                toggleBtn.addEventListener('click', function(e) {
                    createSparkles(e);
                    createFloatingElement('âœ¨ Night Mode âœ¨');
                });
            }
            
            // Initialize first stage
            createFloatingElements();
            createHeartConfetti(10);
            
            // Auto navigation every 45 seconds
            const autoNav = setInterval(() => {
                if (currentStage < 5) {
                    navigateToStage(currentStage + 1);
                } else {
                    clearInterval(autoNav);
                }
            }, 45000);
        });
    </script>
</body>
</html>
