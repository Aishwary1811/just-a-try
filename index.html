<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Happy Birthday Lakshtu ðŸ’–</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap');
:root{--bg1:#fff6f3;--bg2:#ffeef9;--accent:#ff4f9a;--peach:#ffb88c;--muted:#63414a}
*{box-sizing:border-box}
html,body{height:100%;margin:0;font-family:'Poppins',sans-serif;background:linear-gradient(160deg,var(--bg1),var(--bg2));color:var(--muted);-webkit-font-smoothing:antialiased}
.container{min-height:100vh;display:flex;align-items:center;justify-content:center;padding:20px;position:relative;overflow:hidden}
.bg-soft{position:absolute;inset:-20%;background:radial-gradient(circle at 10% 20%, rgba(255,210,190,0.12), transparent 12%),radial-gradient(circle at 80% 80%, rgba(230,200,255,0.08), transparent 12%);transform:scale(1.02);animation:bgMove 14s linear infinite;z-index:0}
@keyframes bgMove{0%{transform:translateY(0) scale(1.02)}50%{transform:translateY(-30px) scale(1.01)}100%{transform:translateY(0) scale(1.02)}}
.card{position:relative;z-index:4;width:100%;max-width:980px;background:rgba(255,255,255,0.96);border-radius:16px;padding:20px;box-shadow:0 30px 80px rgba(120,50,80,0.06);display:flex;flex-direction:column;align-items:center;gap:12px}
.header-heart{width:68px;height:68px;background-image:url('heart.png');background-size:contain;background-repeat:no-repeat;border-radius:12px;box-shadow:0 12px 30px rgba(255,110,170,0.12)}
.btn{display:inline-flex;align-items:center;gap:10px;padding:12px 20px;border-radius:999px;border:none;color:white;font-weight:700;cursor:pointer;background:linear-gradient(180deg,var(--peach),var(--accent));box-shadow:0 12px 30px rgba(255,100,150,0.14);transition:transform .18s}
.btn:active{transform:translateY(1px)}
.btn.secondary{background:linear-gradient(180deg,#aebaff,#c89bff)}
.stage{width:100%;display:flex;flex-direction:column;align-items:center;gap:12px;transition:opacity .5s, transform .5s}
.hidden{display:none}
#envelope{width:320px;max-width:86vw;border-radius:12px;cursor:pointer;box-shadow:0 18px 40px rgba(0,0,0,0.12);transition:transform .5s}
#envelope:hover{transform:translateY(-6px)}
#treeWrap{width:100%;max-width:420px;height:360px;position:relative;display:flex;align-items:center;justify-content:center}
#leafLayer{position:absolute;left:50%;transform:translateX(-50%);bottom:80px;width:320px;height:220px;pointer-events:none}
.tree-heart{position:absolute;width:30px;height:30px;background-image:url('heart.png');background-size:contain;background-repeat:no-repeat;opacity:0;transform:scale(.35) translateY(18px);transition:transform .85s cubic-bezier(.2,.9,.2,1),opacity .85s,filter .85s}
.tree-heart.pop{opacity:1;transform:scale(1) translateY(0);filter:drop-shadow(0 10px 22px rgba(255,120,170,0.14))}
#cakeBox{display:flex;flex-direction:column;align-items:center;gap:8px}
#cakeImg{width:360px;max-width:88vw;border-radius:16px;cursor:pointer;box-shadow:0 26px 68px rgba(0,0,0,0.12);transition:transform .18s}
#cakeImg:active{transform:scale(.94)}
.candle{position:relative;width:8px;height:34px;background:#fff;border-radius:8px;left:50%;transform:translateX(-50%);top:-52px;opacity:0}
.flame{position:absolute;left:50%;top:-18px;width:14px;height:14px;border-radius:50%;transform:translateX(-50%);background:radial-gradient(circle,#ffd800 0%, #ff5e00 70%);filter:drop-shadow(0 8px 14px rgba(255,120,60,0.3));opacity:0}
.balloon{position:absolute;width:46px;height:66px;border-radius:60%;bottom:-120px;opacity:0;transform:translateY(0);transition:transform 3s cubic-bezier(.2,.9,.2,1),opacity .4s}
.balloon.a{left:10%;background:linear-gradient(180deg,#ff94c8,#ff4f9a)}
.balloon.b{right:12%;background:linear-gradient(180deg,#ffd17a,#ff7a5a)}
#gift3D{width:240px;height:140px;border-radius:12px;background:linear-gradient(180deg,#fff3e6,#ffd6b3);display:flex;align-items:center;justify-content:center;cursor:pointer;box-shadow:0 22px 68px rgba(255,150,120,0.12);position:relative;overflow:visible;transform-style:preserve-3d;transition:transform .45s}
.lid{position:absolute;top:-18px;left:50%;transform:translateX(-50%);width:260px;height:44px;background:linear-gradient(180deg,#ffd8b0,#ffb07a);border-radius:8px;transform-origin:50% 100%;transition:transform .6s}
.lid.open{transform:translateX(-50%) rotateX(-78deg) translateY(-14px)}
#finalPanel{width:92%;max-width:760px;background:linear-gradient(180deg,#fff7f9,#fff2f6);border-radius:14px;padding:18px;margin-top:12px;box-shadow:0 20px 48px rgba(255,150,190,0.07);display:none;text-align:left;position:relative;overflow:visible}
.typewriter{white-space:pre-wrap;font-weight:500;font-size:16px}
.cursor{display:inline-block;width:10px;height:18px;background:var(--accent);margin-left:8px;border-radius:3px;animation:blink 1s steps(2,start) infinite}
@keyframes blink{50%{opacity:0}}
#loveYou{font-size:36px;font-weight:800;text-align:center;width:100%;margin-top:18px;color:#ff2e74;opacity:0;transform:translateY(40px) scale(.8);text-shadow:0 0 18px rgba(255,80,150,0.55),0 0 30px rgba(255,120,180,0.45)}
.show-love{animation:loveRise 1.1s cubic-bezier(.2,.9,.2,1) forwards}
@keyframes loveRise{0%{opacity:0;transform:translateY(40px) scale(.8)}60%{opacity:1;transform:translateY(-6px) scale(1.05)}100%{opacity:1;transform:translateY(0) scale(1)}}
.firework{position:absolute;width:8px;height:8px;border-radius:50%;background:#ff6fb9;animation:fw 900ms ease-out forwards}
@keyframes fw{0%{transform:scale(.2);opacity:1}70%{transform:scale(2.2);opacity:0.8}100%{transform:scale(3.3);opacity:0}}
/* improved gallery layout */
.gallery-section{width:92%;max-width:880px;margin:12px auto 0}
.gallery-title{font-size:18px;color:#ff5599;font-weight:700;margin-bottom:10px;text-align:center}
.gallery-grid{display:grid;grid-template-columns:repeat(6,1fr);grid-auto-rows:160px;gap:12px}
.gallery-item{position:relative;overflow:hidden;border-radius:12px}
.gallery-item img{width:100%;height:100%;object-fit:cover;display:block}
.item-big{grid-column:span 2;grid-row:span 2;object-position:center top}
.item-mid{grid-column:span 2}
.item-small{grid-column:span 2}
@media(max-width:800px){.gallery-grid{grid-template-columns:repeat(3,1fr);grid-auto-rows:140px}.item-big{grid-column:span 3;grid-row:span 1}}
.confetti{position:absolute;width:8px;height:8px;border-radius:50%;pointer-events:none;opacity:.95;transform:translateY(-120px);animation:confettiFall 2.4s linear forwards}
@keyframes confettiFall{to{transform:translateY(250px) rotate(360deg);opacity:0.6}}
.sparkle{position:absolute;width:6px;height:6px;border-radius:50%;pointer-events:none;transform:scale(.2);animation:sparklePop 700ms ease forwards}
@keyframes sparklePop{0%{transform:scale(.2) translateY(0);opacity:0}40%{transform:scale(1.05) translateY(-6px);opacity:1}100%{transform:scale(.6) translateY(-30px);opacity:0}}
@media(max-width:560px){#cakeImg{width:86vw}#envelope{width:86vw}}
</style>
</head>
<body>
<div class="bg-soft" aria-hidden="true"></div>
<div class="container">
  <div class="card" role="main">
    <div class="header-heart" aria-hidden="true"></div>
    <div id="intro" class="stage">
      <h2 style="margin:6px 0;color:var(--accent)">It's your special day!</h2>
      <div style="color:#7a3b54;margin-bottom:6px">Ready to open your surprise?</div>
      <div style="display:flex;gap:12px">
        <button id="startBtn" class="btn">Start & Play Music ðŸ’–</button>
        <button id="galleryBtn" class="btn secondary">Open Gallery</button>
      </div>
    </div>
    <div id="envelopeStage" class="stage hidden">
      <img id="envelope" src="envelope.png" alt="envelope"/>
      <div style="font-size:13px;color:#7a3b54">Tap the envelope ðŸ’Œ</div>
    </div>
    <div id="treeStage" class="stage hidden">
      <div id="treeWrap">
        <svg id="treeCanvas" viewBox="0 0 380 340" style="width:100%;height:100%"></svg>
        <div id="leafLayer"></div>
      </div>
      <div style="font-size:13px;color:#7a3b54">Tree grows slowly â€” watch the blossoms ðŸŒ³ðŸ’–</div>
    </div>
    <div id="cakeStage" class="stage hidden">
      <div id="cakeBox">
        <div class="candle" id="candle"><div class="flame" id="flame"></div></div>
        <img id="cakeImg" src="cake.jpg" alt="cake"/>
      </div>
      <div style="font-size:13px;color:#7a3b54">Tap the cake to cut it ðŸŽ‚</div>
    </div>
    <div id="giftStage" class="stage hidden">
      <div id="gift3D">
        <div class="lid" id="lid"></div>
        <div id="giftText">Open Gift</div>
      </div>
    </div>
    <div id="finalStage" class="stage hidden">
      <div id="finalPanel">
        <div id="typed" class="typewriter"></div><span id="cursor" class="cursor"></span>
        <div id="loveYou">I LOVE YOU, LAKSHTU ðŸ’–âœ¨</div>
      </div>
      <div style="display:flex;gap:8px;margin-top:10px">
        <button id="skipBtn" class="btn" style="background:linear-gradient(180deg,#ffe6e8,#ff9ab1)">Skip Typing</button>
        <button id="replayBtn" class="btn" style="background:linear-gradient(180deg,#a3ffd8,#7af1c4)">Replay</button>
      </div>
    </div>
    <!-- improved gallery placed here -->
    <section id="gallerySection" class="stage hidden">
      <div class="gallery-section">
        <div class="gallery-title">Our Beautiful Moments ðŸ’—</div>
        <div class="gallery-grid" id="galleryGrid">
          <div class="gallery-item item-big"><img id="imgBig" src="pic_three.png" alt="Her Eyes"/></div>
          <div class="gallery-item item-mid"><img id="imgOne" src="pic_one.jpg" alt="Memory 1"/></div>
          <div class="gallery-item item-small"><img id="imgTwo" src="pic_two.jpg" alt="Memory 2"/></div>
        </div>
      </div>
    </section>
  </div>
</div>
<div id="confettiRoot" aria-hidden="true"></div>
<audio id="bgm" src="song.mp3" preload="auto" loop></audio>
<script>
/* ---------- Elements ---------- */
const startBtn = document.getElementById('startBtn');
const galleryBtn = document.getElementById('galleryBtn');
const envelopeStage = document.getElementById('envelopeStage');
const envelope = document.getElementById('envelope');
const treeStage = document.getElementById('treeStage');
const leafLayer = document.getElementById('leafLayer');
const cakeStage = document.getElementById('cakeStage');
const cakeImg = document.getElementById('cakeImg');
const candle = document.getElementById('candle');
const flame = document.getElementById('flame');
const giftStage = document.getElementById('giftStage');
const lid = document.getElementById('lid');
const finalStage = document.getElementById('finalStage');
const typed = document.getElementById('typed');
const cursor = document.getElementById('cursor');
const skipBtn = document.getElementById('skipBtn');
const replayBtn = document.getElementById('replayBtn');
const gallerySection = document.getElementById('gallerySection');
const galleryGrid = document.getElementById('galleryGrid');
const imgBig = document.getElementById('imgBig');
const imgOne = document.getElementById('imgOne');
const imgTwo = document.getElementById('imgTwo');
const confettiRoot = document.getElementById('confettiRoot');
const bgm = document.getElementById('bgm');

/* ---------- Small helpers ---------- */
let audioCtx = null;
function ensureAudio(){ if(!audioCtx) audioCtx = new (window.AudioContext || window.webkitAudioContext)(); }
function tone(freq=820,dur=200){ ensureAudio(); const o=audioCtx.createOscillator(), g=audioCtx.createGain(); o.type='triangle'; o.frequency.value=freq; const o2=audioCtx.createOscillator(); o2.type='sine'; o2.frequency.value=freq*1.45; g.gain.setValueAtTime(0,audioCtx.currentTime); g.gain.linearRampToValueAtTime(0.12,audioCtx.currentTime+0.01); g.gain.exponentialRampToValueAtTime(0.001,audioCtx.currentTime+dur/1000); o.connect(g); o2.connect(g); g.connect(audioCtx.destination); o.start(); o2.start(); setTimeout(()=>{ o.stop(); o2.stop(); g.disconnect(); }, dur+30); }

/* confetti */
function spawnConfetti(x,y,count=12){ for(let i=0;i<count;i++){ const c = document.createElement('div'); c.className='confetti'; c.style.left = (x + (Math.random()*140 - 70)) + 'px'; c.style.top  = (y + (Math.random()*40 - 20)) + 'px'; c.style.background = `hsl(${Math.random()*40 + 320},80%,76%)`; document.body.appendChild(c); setTimeout(()=> c.remove(), 2600 + Math.random()*1400); } }
function spawnSparksOver(el,count=8){ const r = el.getBoundingClientRect(); for(let i=0;i<count;i++){ const s = document.createElement('div'); s.className='sparkle'; s.style.left = (r.left + 8 + Math.random()*(r.width-16)) + 'px'; s.style.top  = (r.top + 8 + Math.random()*(r.height-16)) + 'px'; s.style.background = `hsl(${Math.random()*40 + 320},80%,76%)`; document.body.appendChild(s); setTimeout(()=> s.remove(), 900 + Math.random()*700); } }

/* ---------- Flow ---------- */
startBtn.addEventListener('click', ()=>{
  bgm.play().catch(()=>{});
  document.getElementById('intro').classList.add('hidden');
  envelopeStage.classList.remove('hidden');
});

galleryBtn.addEventListener('click', ()=>{
  // open improved gallery
  gallerySection.classList.remove('hidden');
  imgBig.style.opacity=0; imgOne.style.opacity=0; imgTwo.style.opacity=0;
  setTimeout(()=>{ imgBig.style.transition='opacity .6s'; imgBig.style.opacity=1; },200);
  setTimeout(()=>{ imgOne.style.transition='opacity .6s'; imgOne.style.opacity=1; },500);
  setTimeout(()=>{ imgTwo.style.transition='opacity .6s'; imgTwo.style.opacity=1; },800);
});

envelope.addEventListener('click', async ()=>{
  envelopeStage.classList.add('hidden'); treeStage.classList.remove('hidden');
  const count=18; for(let i=0;i<count;i++){ createHeartOnTree(i,count); await new Promise(r=>setTimeout(r,200)); }
  setTimeout(()=>{ treeStage.classList.add('hidden'); cakeStage.classList.remove('hidden'); showCandle(); },1200);
});

function createHeartOnTree(index,total){ const w=leafLayer.clientWidth||320; const h=leafLayer.clientHeight||180; const layer=Math.floor(Math.random()*4); const y=h*(0.2+layer*0.18+Math.random()*0.07); const spread=0.35+layer*0.22+Math.random()*0.25; const center=w/2; const x=center + (Math.random()*2-1)*w*spread*0.42; const el=document.createElement('div'); el.className='tree-heart'; el.style.left=Math.max(4,Math.min(w-34,x))+'px'; el.style.top=Math.max(4,Math.min(h-34,y))+'px'; leafLayer.appendChild(el); setTimeout(()=>{ el.classList.add('pop'); tone(700+Math.random()*200,160); },120+index*180); setTimeout(()=>{ el.style.transition='transform 2200ms ease, opacity 2200ms ease'; el.style.transform=`translateY(-74px) scale(.6) rotate(${Math.random()*360}deg)`; el.style.opacity=0; setTimeout(()=>el.remove(),2200); },3500+Math.random()*1200); }

cakeImg.addEventListener('click', ()=>{
  const rect = cakeImg.getBoundingClientRect(); spawnConfetti(rect.left + rect.width/2, rect.top + 20, 14); createBalloon('a', rect.left + 40); createBalloon('b', rect.right - 60); setTimeout(()=>{ cakeStage.classList.add('hidden'); giftStage.classList.remove('hidden'); openGift(); },1400);
});

function createBalloon(type,leftPx){ const b=document.createElement('div'); b.className='balloon '+(type==='a'?'a':'b'); b.style.left=leftPx+'px'; b.style.bottom='-140px'; document.body.appendChild(b); setTimeout(()=>{ b.style.opacity=1; b.style.transform='translateY(-420px)'; },60); setTimeout(()=> b.remove(),7000); }

function openGift(){ lid.classList.add('open'); tone(920,220); spawnConfetti(window.innerWidth/2, window.innerHeight/2, 20); spawnSparksOver(document.getElementById('gift3D'),12); ribbonBurst(window.innerWidth/2-40, window.innerHeight/2-20); setTimeout(()=>{ giftStage.classList.add('hidden'); finalStage.classList.remove('hidden'); startTyping(); },900); }

function ribbonBurst(x,y){ for(let i=0;i<12;i++){ const r=document.createElement('div'); r.style.position='absolute'; r.style.left=x+'px'; r.style.top=y+'px'; r.style.width='6px'; r.style.height=(40+Math.random()*40)+'px'; r.style.background=`linear-gradient(180deg,#ffb4d6,#ff6a96)`; r.style.borderRadius='4px'; r.style.transformOrigin='top center'; r.style.zIndex=8; r.style.pointerEvents='none'; document.body.appendChild(r); const ang=(Math.random()*120-60)*(Math.PI/180); r.animate([{transform:`rotate(${ang}rad) translateY(0)`,opacity:1},{transform:`rotate(${ang}rad) translateY(-220px)`,opacity:0}],{duration:1200+Math.random()*700,easing:'cubic-bezier(.2,.9,.2,1)'}); setTimeout(()=>r.remove(),2000); } }

/* typing */
const message = `My sweet Lakshtu,

You make my world brighter just by being in it. You are the kindest part of my heart â€” the calm in my chaos, and the softest place where my feelings rest.

Thank you for loving me in your own little ways, for supporting me, for choosing me, and for making every day feel special without even trying.

On your birthday, I just want you to know â€” you are precious to me, you are loved more than words can hold, and you will always, always have a place in my heart.

Happy Birthday, my love.
My sweetest girl.
My Lakshtu. ðŸ’–âœ¨`;
let tIndex=0,tTimer=null,typing=true;
function startTyping(){ typed.textContent=''; tIndex=0; typing=true; cursor.style.display='inline-block'; document.getElementById('loveYou').classList.remove('show-love'); function step(){ if(tIndex < message.length){ const ch=message.charAt(tIndex++); typed.textContent += ch; if(ch==='
'){ spawnSparksOver(document.getElementById('finalPanel'),6); tone(720+Math.random()*260,200); } tTimer=setTimeout(step,28+Math.random()*18); } else{ typing=false; cursor.style.display='none'; setTimeout(()=>{ document.getElementById('loveYou').classList.add('show-love'); softFirework(document.getElementById('finalPanel').getBoundingClientRect().left + document.getElementById('finalPanel').clientWidth/2, document.getElementById('finalPanel').getBoundingClientRect().top + 60); spawnSparksOver(document.getElementById('finalPanel'),12); },420); setTimeout(()=>{ gallerySection.classList.remove('hidden'); imgBig.style.opacity=0; imgOne.style.opacity=0; imgTwo.style.opacity=0; setTimeout(()=> imgBig.style.opacity=1,200); setTimeout(()=> imgOne.style.opacity=1,500); setTimeout(()=> imgTwo.style.opacity=1,800); },1400); } } step(); }
skipBtn.addEventListener('click', ()=>{ if(typing){ clearTimeout(tTimer); typed.textContent = message; typing=false; cursor.style.display='none'; document.getElementById('loveYou').classList.add('show-love'); spawnSparksOver(document.getElementById('finalPanel'),12); softFirework(document.getElementById('finalPanel').getBoundingClientRect().left + document.getElementById('finalPanel').clientWidth/2, document.getElementById('finalPanel').getBoundingClientRect().top + 60); gallerySection.classList.remove('hidden'); } });
replayBtn.addEventListener('click', ()=>{ if(tTimer) clearTimeout(tTimer); typed.textContent=''; startTyping(); });

/* other effects */
function showCandle(){ candle.style.opacity=1; flame.style.opacity=1; tone(980,120); flame.animate([{transform:'translateY(0) scale(1)'},{transform:'translateY(-4px) scale(1.04)'}],{duration:900,iterations:Infinity,direction:'alternate'}); }
function softFirework(x,y){ const root=document.createElement('div'); root.className='firework'; root.style.left=(x-80)+'px'; root.style.top=(y-80)+'px'; document.body.appendChild(root); const svgNS='http://www.w3.org/2000/svg'; const svg=document.createElementNS(svgNS,'svg'); svg.setAttribute('width','160'); svg.setAttribute('height','160'); root.appendChild(svg); for(let i=0;i<18;i++){ const c=document.createElementNS(svgNS,'circle'); const a=Math.random()*Math.PI*2; const r=20+Math.random()*62; const cx=80+Math.cos(a)*r; const cy=80+Math.sin(a)*r; c.setAttribute('cx',80); c.setAttribute('cy',80); c.setAttribute('r',4+Math.random()*5); c.setAttribute('fill',`hsl(${320+Math.random()*40},85%,70%)`); svg.appendChild(c); c.animate([{cx:80,cy:80,opacity:1},{cx:cx,cy:cy,opacity:0.1}],{duration:900+Math.random()*600,easing:'cubic-bezier(.2,.9,.2,1)'}); }
setTimeout(()=> root.remove(),1700); }

/* periodic confetti/petals */
setInterval(()=>{ if(!finalStage.classList.contains('hidden') && Math.random()<0.12){ softFirework(80 + Math.random()*(innerWidth-160), 80 + Math.random()*(innerHeight/2)); } },1800);

/* accessibility: pause audio on pagehide */
window.addEventListener('pagehide', ()=> bgm.pause());

/* asset check (console) */
(async function checkFiles(){ const files=['song.mp3','envelope.png','cake.jpg','heart.png','pic_one.jpg','pic_two.jpg','pic_three.png']; const missing=[]; for(const f of files){ try{ const r=await fetch(f,{method:'HEAD'}); if(!r.ok) missing.push(f);}catch(e){ missing.push(f);} } if(missing.length) console.warn('Missing (ensure files in repo root):', missing); })();
</script>


<!-- GALLERY MOVED HERE (After Gift Opening, Before Final Letter) -->
<section id="gallery" class="gallery-section" style="display:none;">
  <h2 class="gallery-title">Our Beautiful Moments ðŸ’—</h2>
  <div class="gallery-grid">
    <div class="gallery-item tall">
      <img src="pic_three.png" alt="Her Eyes" />
    </div>
    <div class="gallery-item">
      <img src="pic_one.jpg" alt="Memory 1" />
    </div>
    <div class="gallery-item">
      <img src="pic_two.jpg" alt="Memory 2" />
    </div>
  </div>
</section>

<style>
  .gallery-section { padding: 40px 20px; text-align:center; }
  .gallery-title { font-size:2rem; margin-bottom:20px; color:#ff5599; font-weight:700; }
  .gallery-grid { display:grid; grid-template-columns:repeat(auto-fit,minmax(250px,1fr)); gap:25px; width:90%; margin:auto; }
  .gallery-item { overflow:hidden; border-radius:20px; box-shadow:0 8px 20px rgba(0,0,0,0.15); transition:0.4s ease; }
  .gallery-item:hover { transform:scale(1.05); box-shadow:0 10px 30px rgba(0,0,0,0.25); }
  .gallery-item img { width:100%; height:100%; object-fit:cover; }
  .gallery-item.tall img { object-position:center top; }
</style>

<script>
// Show gallery after gift opens
function showGalleryAfterGift() {
  const gallery = document.getElementById('gallery');
  gallery.style.display = 'block';
  gallery.scrollIntoView({ behavior: 'smooth' });
}
</script>

</body>
</html>
