<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Happy Birthday Lakshtu ðŸ’–</title>
<style>
  /* Fonts */
  @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap');

  :root{
    --bg1: #ffe9df;    /* warm peach */
    --bg2: #ffdff4;    /* baby pink/lavender */
    --accent: #ff4f9a;
    --gold: #ffd166;
    --muted: #5b3140;
  }

  html,body{height:100%; margin:0; font-family:'Poppins',sans-serif; background: linear-gradient(135deg,var(--bg1),var(--bg2)); color:var(--muted); overflow-x:hidden;}
  .center { position: absolute; left:50%; top:50%; transform: translate(-50%,-50%); width:94%; max-width:520px; text-align:center; }

  /* Card */
  .card { background: rgba(255,255,255,0.94); border-radius:18px; padding:22px; box-shadow: 0 18px 50px rgba(0,0,0,0.06); }

  h1 { margin:8px 0 6px; color:var(--accent); font-size:22px; }
  p.lead { margin:8px 0 18px; color:#7b465b; }

  button{
    background: linear-gradient(180deg,var(--gold),var(--accent));
    border:none; color:white; padding:12px 20px; border-radius:12px; font-weight:700; cursor:pointer;
    box-shadow: 0 10px 30px rgba(255,100,150,0.15);
  }
  button:active{ transform: translateY(1px) scale(.997); }

  /* floaty for decorative elements */
  .floaty { animation: floaty 3s ease-in-out infinite; }
  @keyframes floaty { 0%,100%{ transform: translateY(0) } 50%{ transform: translateY(-10px) } }

  /* fade utility */
  .hidden{ display:none !important; }
  .fade { opacity:0; transition: opacity .8s ease, transform .6s ease; transform-origin:center; }
  .in { opacity:1; transform: none; }

  /* envelope */
  #envelope { width:300px; max-width:86vw; cursor:pointer; border-radius:14px; box-shadow:0 16px 40px rgba(0,0,0,0.12); display:block; margin:0 auto; }

  /* tree container (envelope morphs into tree) */
  #treeWrap { width:340px; height:320px; margin:0 auto; position:relative; display:none; }
  #treeTrunk {
    position:absolute; left:50%; transform:translateX(-50%) scale(0.85);
    bottom:48px; width:34px; height:140px; background:linear-gradient(180deg,#8b5a3a,#6b3f2a); border-radius:10px;
    box-shadow:0 10px 30px rgba(0,0,0,0.12); opacity:0; transition: opacity 900ms ease, transform 900ms cubic-bezier(.2,.9,.2,1);
  }
  #leafArea { position:absolute; left:50%; transform:translateX(-50%); bottom:160px; width:320px; height:140px; pointer-events:none; }

  .leaf {
    position:absolute; width:26px; height:26px; background-image:url('heart.png'); background-size:contain; background-repeat:no-repeat;
    opacity:0; transform: scale(.4) translateY(12px) rotate(0deg);
    transition: transform 700ms cubic-bezier(.2,.9,.2,1), opacity 700ms ease;
    filter: drop-shadow(0 8px 14px rgba(255,125,170,0.16));
  }

  /* cake */
  #cake { width:320px; max-width:88vw; display:none; margin: 8px auto; cursor:pointer; border-radius:16px; box-shadow:0 18px 48px rgba(0,0,0,0.15); }
  #cake.smallPress { transform: scale(.94); transition: transform .18s ease; }

  /* gift */
  #giftBox {
    width:240px; height:140px; margin: 18px auto; border-radius:16px; display:none; cursor:pointer;
    background: linear-gradient(180deg,#ffe6cc,#ffd1a8);
    box-shadow: 0 24px 60px rgba(255,150,120,0.12), inset 0 -6px 20px rgba(255,200,160,0.06);
    display:flex; align-items:center; justify-content:center; font-weight:800; color:#6b2f47;
  }

  /* final letter panel */
  #finalPanel {
    display:none; width:92%; max-width:720px; margin:18px auto; background: linear-gradient(180deg,#fff7f9,#fff2f6);
    border-radius:14px; padding:18px; box-shadow:0 18px 44px rgba(255,150,190,0.08); color:#5b2b44; text-align:left; line-height:1.55;
  }
  .typewriter { white-space: pre-wrap; font-weight:500; font-size:15.5px; }
  .cursor { display:inline-block; width:10px; margin-left:6px; background:var(--accent); height:18px; vertical-align:bottom; border-radius:3px; animation: blink 1s steps(2,start) infinite;}
  @keyframes blink { 50%{ opacity:0 } }

  /* photos */
  #photos { display:none; margin-top:18px; }
  #photos img { width:280px; max-width:86vw; margin:10px; border-radius:12px; box-shadow:0 18px 45px rgba(0,0,0,0.12); opacity:0; transform: translateY(20px); transition: transform .6s ease, opacity .6s ease; }
  #photos img.show { opacity:1; transform: translateY(0); }

  /* confetti & sparkles */
  .confetti { position:absolute; width:8px; height:8px; border-radius:50%; pointer-events:none; opacity:.95; transform: translateY(-120px); animation: confettiFall 2.4s linear forwards; }
  @keyframes confettiFall { to { transform: translateY(240px) rotate(360deg); opacity:0.6; } }

  .sparkle { position:absolute; width:6px; height:6px; border-radius:50%; pointer-events:none; transform: scale(.2); animation: sparklePop 700ms ease forwards; filter: drop-shadow(0 8px 16px rgba(255,190,210,0.18)); }
  @keyframes sparklePop { 0% { transform: scale(.2) translateY(0); opacity:0 } 40% { transform: scale(1.05) translateY(-6px); opacity:1 } 100% { transform: scale(.6) translateY(-30px); opacity:0 } }

  /* utilities */
  .mini { font-size:13px; color:#7a3b54; margin-top:8px; }
  @media (max-width:420px){ #envelope{width:86vw;} #cake{width:86vw;} #giftBox{width:86vw} }
</style>
</head>
<body>

<!-- audio -->
<audio id="bgm" src="song.mp3" preload="auto" loop></audio>

<!-- Intro -->
<div id="intro" class="center">
  <div class="card">
    <img src="heart.png" alt="heart" style="width:78px;height:78px; display:block; margin:0 auto; border-radius:12px; box-shadow:0 10px 30px rgba(255,120,170,0.16)" />
    <h1>It's your special day!</h1>
    <p class="lead">Do you want to see your gift?</p>
    <button id="yesBtn">Yes ðŸ’–</button>
  </div>
</div>

<!-- Envelope (will morph to tree) -->
<div id="envelopeArea" class="center hidden">
  <img id="envelope" src="envelope.png" alt="envelope" class="fade"/>
  <div class="mini">Tap the envelope to open ðŸ’Œ</div>
</div>

<!-- Tree area (envelope morphs into this) -->
<div id="treeArea" class="center hidden" style="width:360px;">
  <div id="treeWrap" style="display:none;">
    <div id="leafArea"></div>
    <div id="treeTrunk"></div>
  </div>
  <div class="mini">The tree grows with heart leaves ðŸŒ³ðŸ’–</div>
</div>

<!-- Cake -->
<div id="cakeArea" class="center hidden">
  <img id="cake" src="cake.jpg" alt="cake" />
  <div class="mini">Tap cake to cut it ðŸŽ‚</div>
</div>

<!-- Gift -->
<div id="giftArea" class="center hidden">
  <div id="giftBox" title="Click to open the final gift">Open Gift</div>
  <div class="mini">Click the gift to reveal the final letter</div>
</div>

<!-- Final panel (typewriter effect) -->
<div id="finalArea" class="center hidden">
  <div id="finalPanel">
    <div id="typed" class="typewriter"></div><span id="cursor" class="cursor"></span>
  </div>
</div>

<!-- Photos -->
<div id="photos" class="center hidden">
  <img id="ph1" src="pic_one.jpg" alt="pic1" />
  <img id="ph2" src="pic_two.jpg" alt="pic2" />
  <img id="ph3" src="pic_three.png" alt="pic3" />
</div>

<script>
/* ---------- Elements ---------- */
const yesBtn = document.getElementById('yesBtn');
const bgm = document.getElementById('bgm');
const intro = document.getElementById('intro');

const envelopeArea = document.getElementById('envelopeArea');
const envelope = document.getElementById('envelope');

const treeArea = document.getElementById('treeArea');
const treeWrap = document.getElementById('treeWrap');
const treeTrunk = document.getElementById('treeTrunk');
const leafArea = document.getElementById('leafArea');

const cakeArea = document.getElementById('cakeArea');
const cake = document.getElementById('cake');

const giftArea = document.getElementById('giftArea');
const giftBox = document.getElementById('giftBox');

const finalArea = document.getElementById('finalArea');
const typed = document.getElementById('typed');
const cursor = document.getElementById('cursor');

const photos = document.getElementById('photos');
const ph1 = document.getElementById('ph1'), ph2 = document.getElementById('ph2'), ph3 = document.getElementById('ph3');

/* Final combined letter text */
const finalText = `My sweet Lakshtu,

You make my world brighter just by being in it. You are the kindest part of my heart â€” the calm in my chaos, and the softest place where my feelings rest.

Thank you for loving me in your own little ways, for supporting me, for choosing me, and for making every day feel special without even trying.

On your birthday, I just want you to know â€” you are precious to me, you are loved more than words can hold, and you will always, always have a place in my heart.

Happy Birthday, my love.
My sweetest girl.
My Lakshtu. ðŸ’–âœ¨`;

/* ---------- WebAudio simple tone ---------- */
let audioCtx = null;
function ensureAudio(){ if(!audioCtx) audioCtx = new (window.AudioContext || window.webkitAudioContext)(); }
function playTone(freq = 880, dur = 240){
  ensureAudio();
  const o = audioCtx.createOscillator();
  const g = audioCtx.createGain();
  o.type = 'triangle'; o.frequency.value = freq;
  const o2 = audioCtx.createOscillator(); o2.type='sine'; o2.frequency.value = freq*1.45;
  g.gain.setValueAtTime(0, audioCtx.currentTime);
  g.gain.linearRampToValueAtTime(0.12, audioCtx.currentTime + 0.01);
  g.gain.exponentialRampToValueAtTime(0.001, audioCtx.currentTime + dur/1000);
  o.connect(g); o2.connect(g); g.connect(audioCtx.destination);
  o.start(); o2.start();
  setTimeout(()=>{ o.stop(); o2.stop(); g.disconnect(); }, dur + 30);
}

/* ---------- Helper: spawn confetti on element ---------- */
function spawnConfettiOn(el, count=14){
  for(let i=0;i<count;i++){
    const c = document.createElement('div');
    c.className = 'confetti';
    c.style.left = (20 + Math.random()* (el.clientWidth-40)) + 'px';
    c.style.top = (10 + Math.random()*20) + 'px';
    c.style.background = `hsl(${Math.random()*40 + 320}, 84%, 76%)`;
    el.appendChild(c);
    setTimeout(()=> c.remove(), 2600 + Math.random()*1200);
  }
}

/* ---------- Intro Yes -> show envelope ---------- */
yesBtn.addEventListener('click', ()=>{
  bgm.play().catch(()=>{});            // start audio after user action
  intro.classList.add('hidden');
  envelopeArea.classList.remove('hidden');
  setTimeout(()=> envelope.classList.add('in'), 40);
});

/* ---------- Envelope click -> morph into tree ---------- */
envelope.addEventListener('click', () => {
  // hide envelopeArea then show treeWrap (we animate transform)
  envelopeArea.classList.add('hidden');

  // show tree area container
  treeArea.classList.remove('hidden');

  // Show treeWrap (this will represent transformed envelope â†’ tree)
  treeWrap.style.display = 'block';
  treeWrap.style.opacity = 0;
  treeWrap.style.transform = 'scale(.88) translateY(20px)';
  setTimeout(()=> { treeWrap.style.transition = 'opacity .9s ease, transform .9s cubic-bezier(.2,.9,.2,1)'; treeWrap.style.opacity = 1; treeWrap.style.transform = 'scale(1) translateY(0)'; }, 60);

  // show trunk with gentle rise
  setTimeout(()=> {
    treeTrunk.style.opacity = 1;
    treeTrunk.style.transform = 'translateX(-50%) scale(1)';
  }, 300);

  // spawn initial leaves with pop
  setTimeout(()=> spawnLeavesBurst(7), 600);

  // after tree grown, show cake
  setTimeout(()=> {
    cakeArea.classList.remove('hidden');
    setTimeout(()=> cake.classList.add('in'), 80);
  }, 1600);
});

/* ---------- Leaves: burst then slow drip ---------- */
let leafInterval = null;
function spawnLeavesBurst(n){
  for(let i=0;i<n;i++){
    setTimeout(()=> createLeafAtRandom(true), i*120);
  }
  // then continue slower
  setTimeout(()=> { leafInterval = setInterval(()=> createLeafAtRandom(false), 700); }, 1000);
}

function createLeafAtRandom(isPop){
  const leaf = document.createElement('div');
  leaf.className = 'leaf';
  const areaW = leafArea.clientWidth || 320, areaH = 120;
  const x = Math.random() * (areaW - 30);
  const y = Math.random() * (areaH - 30);
  leaf.style.left = x + 'px';
  leaf.style.top = y + 'px';
  leafArea.appendChild(leaf);

  // trigger pop animation
  requestAnimationFrame(()=> {
    leaf.style.opacity = 1;
    leaf.style.transform = `scale(${0.92 + Math.random()*0.5}) translateY(0) rotate(${Math.random()*360}deg)`;
    leaf.style.transition = 'transform 850ms cubic-bezier(.2,.9,.2,1), opacity 850ms ease';
  });

  // after some time, float up and fade out
  setTimeout(()=> {
    leaf.style.transition = 'transform 2000ms ease-in, opacity 2000ms ease';
    leaf.style.transform = `translateY(-78px) scale(.6) rotate(${Math.random()*720}deg)`;
    leaf.style.opacity = 0;
    setTimeout(()=> leaf.remove(), 2200);
  }, 1100 + Math.random()*1200);
}

/* ---------- Cake click -> cut -> show gift ---------- */
cake.addEventListener('click', () => {
  // small press animation
  cake.classList.add('smallPress');
  setTimeout(()=> cake.classList.remove('smallPress'), 160);

  // confetti on cake area briefly
  spawnConfettiOn(cake, 10);

  // show gift after a short delay
  setTimeout(()=> {
    giftArea.classList.remove('hidden');
    setTimeout(()=> giftBox.style.transform = 'scale(1.0)', 60);
    spawnConfettiOn(giftBox, 14);
  }, 700);
});

/* ---------- Gift click -> reveal final letter with typewriter ---------- */
giftBox.addEventListener('click', () => {
  if(leafInterval) clearInterval(leafInterval);

  giftArea.classList.add('hidden');
  finalArea.classList.remove('hidden');
  document.getElementById('finalPanel').classList.add('in');

  // start typewriter
  startTypewriter(finalText, typed, 26);
});

/* ---------- Typewriter: triggers sparkles & tone on new lines ---------- */
function spawnSparkles(count=10){
  const panel = document.getElementById('finalPanel');
  const rect = panel.getBoundingClientRect();
  for(let i=0;i<count;i++){
    const s = document.createElement('div');
    s.className = 'sparkle';
    // place relative to panel
    s.style.left = (12 + Math.random()*(rect.width-30)) + 'px';
    s.style.top = (8 + Math.random()*(rect.height-20)) + 'px';
    s.style.background = `hsl(${Math.random()*40 + 320},85%,76%)`;
    panel.appendChild(s);
    setTimeout(()=> s.remove(), 900 + Math.random()*600);
  }
}

function startTypewriter(text, outEl, speed=26){
  outEl.textContent = '';
  cursor.style.display = 'inline-block';
  let i = 0;
  function step(){
    if(i < text.length){
      const ch = text[i++];
      outEl.textContent += ch;
      if(ch === '\n'){
        spawnSparkles(8);
        playTone(660 + Math.random()*380, 240);
      }
      if(ch === ',' || ch === '.'){
        setTimeout(step, speed*8);
      } else {
        setTimeout(step, speed + Math.random()*12);
      }
    } else {
      cursor.style.display = 'none';
      spawnSparkles(18);
      playTone(900, 330);
      // reveal photos after short delay
      setTimeout(()=> revealPhotos(), 900);
    }
  }
  step();
}

/* ---------- Reveal photos ------------- */
function revealPhotos(){
  photos.classList.remove('hidden');
  setTimeout(()=> { ph1.classList.add('show'); ph1.style.display='inline-block'; }, 250);
  setTimeout(()=> { ph2.classList.add('show'); ph2.style.display='inline-block'; }, 850);
  setTimeout(()=> { ph3.classList.add('show'); ph3.style.display='inline-block'; }, 1450);
}

/* ---------- Play a soft tone ---------- */
function ensureAudio(){ if(!audioCtx) audioCtx = new (window.AudioContext || window.webkitAudioContext)(); }
function playTone(freq = 880, dur = 220){
  ensureAudio();
  const o = audioCtx.createOscillator();
  const g = audioCtx.createGain();
  o.type = 'triangle'; o.frequency.value = freq;
  const o2 = audioCtx.createOscillator(); o2.type='sine'; o2.frequency.value = freq*1.45;
  g.gain.setValueAtTime(0, audioCtx.currentTime);
  g.gain.linearRampToValueAtTime(0.12, audioCtx.currentTime + 0.01);
  g.gain.exponentialRampToValueAtTime(0.001, audioCtx.currentTime + dur/1000);
  o.connect(g); o2.connect(g); g.connect(audioCtx.destination);
  o.start(); o2.start();
  setTimeout(()=>{ o.stop(); o2.stop(); g.disconnect(); }, dur + 30);
}

/* create audioCtx variable (for later) */
let audioCtx = null;

/* Accessibility: Allow pressing Enter on gift box */
giftBox.tabIndex = 0;
giftBox.addEventListener('keydown', (e) => { if(e.key === 'Enter') giftBox.click(); });

/* Pause music when leaving */
window.addEventListener('pagehide', ()=> bgm.pause());
</script>
</body>
</html>
